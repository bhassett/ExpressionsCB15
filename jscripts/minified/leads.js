$(window).load(function () { if ("true" == ise.Configuration.getConfigValue("IsAdminCurrentlyLoggedIn")) return !1; var a = getQueryString().process; "" != a && "undefined" != typeof a ? ($("#support-form-wrapper").addClass("display-none"), $("#lead-form-thank-you").fadeIn("slow")) : (InitControls(), GetStringResources("lead-form", !0), LeadFormControlEventsListener()); AjaxSecureEmailAddressVerification(!0, "", "", function (a) { }, function (a) { }) }); function LeadFormControlEventsListener() { $("#btnSubmitLF").click(function () { FinalizeLeadForm() }); $("#captcha-refresh-button").click(function () { captchaCounter++; $("#captcha").attr("src", "Captcha.ashx?id=" + captchaCounter) }); $("#user-control-profile-first-name-input").keypress(function () { $(this).removeClass("lead-duplicates"); $("#user-control-profile-last-name-input").removeClass("lead-duplicates") }); $("#user-control-profile-last-name-input").keypress(function () { $(this).removeClass("lead-duplicates"); $("#user-control-profile-first-name-input").removeClass("lead-duplicates") }) } function FinalizeLeadForm() { $("#ise-message-tips").fadeOut("slow"); var a = 0, e = !1, d = !1; $(".requires-validation").each(function () { var b = trimString($(this).val()); if ("" == b) { d = !1; var c = "#" + $(this).attr("id"), f = $(".zip-city-other-place-holder").css("display"); "#AddressControl_txtCity" == c && ("none" == f ? d = !0 : (d = !0, "" == b && (d = !1))); "#AddressControl_txtState" == c && (c = IsCountryWithStates("#AddressControl_drpCountry"), "none" == f || "false" == c ? d = !0 : (d = !0, "" == b && (d = !1))); b = $(this).attr("id"); IsPostalInputBoxOptional(b) && (d = !0); !1 == d && ($(this).removeClass("current-object-on-focus"), $(this).addClass("required-input"), 0 == a && ($(this).attr("id"), $(this).addClass("current-object-on-focus"), $(this).focus()), e = !0, a++) } }); if (e) return $("").focus(), !1; var b = $("#ProfileControl_txtEmail"); if (b.hasClass("invalid-email") || b.hasClass("email-duplicates")) return b.focus(), !1; if ("undefined" == typeof $("#city-states").val()) { var c = $("#AddressControl_txtPostal").offset().left, f = $("#AddressControl_txtPostal").offset().top; $("#ise-message-tips").css("top", f - 47); $("#ise-message-tips").css("left", c - 17); $("#ise-message").html(ise.StringResource.getString("selectaddress.aspx.11")); $("#ise-message-tips").fadeIn("slow"); return !1 } $("#AddressControl_txtPostal").removeClass("undefined-city-states"); $("#ise-message-tips").fadeOut("slow"); c = b.parent("span").attr("data-accountType"); c = "undefined" == typeof c ? "" : $.trim(c); f = $.trim(ise.StringResource.getString("createaccount.aspx.158")); typeof f != constants.TYPE_UNDEFINED && f != constants.EMPTY && ShowProcessMessage(f, constantID.DIV_ERROR_SUMMARY, constantID.DIV_SAVE_LEAD_LOADER, constantID.DIV_LEAD_BUTTON_CONTAINER); AjaxSecureEmailAddressVerification(!1, b.val(), c, function (a) { a = trimString(a.d); var c = ""; if ("" != a) { switch (a) { case "email-duplicates": c = a; break; case "invalid-email": c = a; break; default: c = "ajax-request-failed" } b.addClass(c).attr("response-message", a); b.focus(); if ("ajax-request-failed" == c) VerifyAddress_v2(); else return hideProgressIndicator(constantID.DIV_SAVE_LEAD_LOADER, constantID.DIV_LEAD_BUTTON_CONTAINER), !1 } else VerifyAddress_v2() }, function (a) { VerifyAddress_v2() }) } function InitControls() { $("#AddressControl_txtPostal").ISEAddressFinder({ "country-id": "#AddressControl_drpCountry", "postal-id": "#AddressControl_txtPostal", "city-id": "#AddressControl_txtCity", "state-id": "#AddressControl_txtState", "city-state-place-holder": ".zip-city-other-place-holder", "enter-postal-label-place-holder": "#enter-postal-label-place-holder", "city-states-id": "city-states" }); $("#AddressControl_txtStreet").ISEBubbleMessage({ "input-id": "AddressControl_txtStreet", "label-id": "AddressControl_lblStreet" }); $("#AddressControl_txtPostal").ISEBubbleMessage({ "input-id": "AddressControl_txtPostal", "label-id": "AddressControl_lblPostal", "input-mode": "postal" }); $("#AddressControl_txtCity").ISEBubbleMessage({ "input-id": "AddressControl_txtCity", "label-id": "AddressControl_lblCity" }); $("#AddressControl_txtState").ISEBubbleMessage({ "input-id": "AddressControl_txtState", "label-id": "AddressControl_lblState", "input-mode": "state" }); "undefined" != typeof $("#AddressControl_txtCounty").val() && $("#AddressControl_txtCounty").ISEBubbleMessage({ "input-id": "AddressControl_txtCounty", "label-id": "AddressControl_lblCounty", optional: !0 }); $("#ProfileControl_txtFirstName").ISEBubbleMessage({ "input-id": "ProfileControl_txtFirstName", "label-id": "lblFirstName" }); $("#ProfileControl_txtLastName").ISEBubbleMessage({ "input-id": "ProfileControl_txtLastName", "label-id": "lblLastName" }); $("#ProfileControl_txtEmail").ISEBubbleMessage({ "input-id": "ProfileControl_txtEmail", "label-id": "lblEmail", "input-mode": "email" }); $("#ProfileControl_txtContactNumber").ISEBubbleMessage({ "input-id": "ProfileControl_txtContactNumber", "label-id": "lblContactNumber" }); $("#ProfileControl_txtMobile").ISEBubbleMessage({ "input-id": "ProfileControl_txtMobile", "label-id": "lblMobile", optional: !0 }); $("#txtMessage").ISEBubbleMessage({ "input-id": "txtMessage", "label-id": "lblMessage" }); $("#txtCaptcha").ISEBubbleMessage({ "input-id": "txtCaptcha", "label-id": "lblCaptcha" }); $("#account-name-wrapper").html(""); $("#passwords-wrapper").html("") } var constantErrorTags = { POSTAL_NOT_FOUND: "invalid-postal-zero", INVALID_EMAIL: "invalid-email", INVALID_POSTAL: "invalid-postal", STATE_NOT_FOUND: "state-not-found", REQUIRED_INPUT: "required-input", PASSWORD_NOT_MATCH: " password-not-match", PASSWORD_NOT_STRONG: "password-not-strong", PASSWORD_LENGTH_INVALID: "password-length-invalid" }, addressConstantID = { DRP_COUNTRY: "AddressControl_drpCountry", HIDDEN_CITYSTATE: "city-states", LABEL_STREET: "AddressControl_lblStreet", LABEL_POSTAL: "AddressControl_lblPostal", LABEL_CITY: "AddressControl_lblCity", LABEL_STATE: "AddressControl_lblState", LABEL_COUNTY: "AddressControl_lblCounty", INPUT_STREET: "AddressControl_txtStreet", INPUT_POSTAL: "AddressControl_txtPostal", INPUT_CITY: "AddressControl_txtCity", INPUT_STATE: "AddressControl_txtState", INPUT_COUNTY: "AddressControl_txtCounty" }, constants = { CONTROL_DISABLED: "control-disabled", DISPLAY_NONE: "display-none", WIDTH_NO_STATE: "city-width-if-no-state", WIDTH_ENTER_POSTAL: "enter-postal-message-width", EMPTY: "", SEP_SPACE: " ", SEP_POUND: "#", SET_DOT: ".", TYPE_WHOLESALE: "wholesale", TYPE_SIGNUP: "signup", TYPE_PROFILE: "profile", TYPE_ADDRESS: "address", TYPE_UNDEFINED: "undefined", TYPE_OTHER: "other", ON_FOCUS: "current-object-on-focus" }, constantID = { DIV_ERROR_SUMMARY: "error-summary", DIV_SAVE_LEAD_LOADER: "save-lead-loader", DIV_LEAD_BUTTON_CONTAINER: "save-lead-button-place-holder" }; function VerifyAddress_v2() { var a = GetObjectControl(addressConstantID.INPUT_POSTAL), e = GetInputValue(addressConstantID.DRP_COUNTRY), d = GetInputValue(addressConstantID.INPUT_POSTAL), b = GetInputValue(addressConstantID.INPUT_STATE), c = !0, f = !0 == a.hasClass("is-postal-optional") && "" == d; IsSearchable(addressConstantID.DRP_COUNTRY) && !1 == f && IsPostalFormatInvalid(e, d) && (a.addClass(constantErrorTags.INVALID_POSTAL), "none" == ConvertStringToLower($(".zip-city-other-place-holder").css("display")) && $(constantID.DIV_ENTER_POSTAL).html(ise.StringResource.getString("customersupport.aspx.40")), c = !1); if (!1 == c) return hideProgressIndicator(constantID.DIV_SAVE_LEAD_LOADER, constantID.DIV_LEAD_BUTTON_CONTAINER), !1; a = {}; a.country = e; a.postal = d; a.stateCode = b; validatePostalCode(a, submitLeadForm) } function validatePostalCode(a, e) { var d = { country: a.country, postal: a.postal, stateCode: a.stateCode, shipToCountry: constants.EMPTY, shipToPostal: constants.EMPTY, shipToStateCode: constants.EMPTY }, b = $.trim(ise.StringResource.getString("createaccount.aspx.159")); typeof b != constants.TYPE_UNDEFINED && b != constants.EMPTY && ShowProcessMessage(b, constantID.DIV_ERROR_SUMMARY, constantID.DIV_SAVE_LEAD_LOADER, constantID.DIV_LEAD_BUTTON_CONTAINER); AjaxCallCommon("ActionService.asmx/ValidatePostalCode", d, function (a) { $postalInputBox = GetObjectControl(addressConstantID.INPUT_POSTAL); GetObjectControl(addressConstantID.INPUT_STATE).removeClass(constantErrorTags.STATE_NOT_FOUND); $postalInputBox.removeClass(constantErrorTags.POSTAL_NOT_FOUND); a = parseInt(a.d); if (0 == a) return e(d), !1; 1 == a && (GetObjectControl(addressConstantID.INPUT_STATE).addClass(constantErrorTags.STATE_NOT_FOUND), $postalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), $postalInputBox.focus()); hideProgressIndicator(constantID.DIV_SAVE_LEAD_LOADER, constantID.DIV_LEAD_BUTTON_CONTAINER) }, function (a) { e(d) }) } function submitLeadForm(a) { var e = function () { var a = $("#txtCityStates"), b = GetInputValue(addressConstantID.HIDDEN_CITYSTATE); a.val(b); b == constants.TYPE_OTHER && (b = GetInputValue(addressConstantID.INPUT_STATE) + ", " + GetInputValue(addressConstantID.INPUT_CITY), $("#txtCityStates").val(b)); ShowProcessMessage(ise.StringResource.getString("leadform.aspx.24"), constantID.DIV_ERROR_SUMMARY, constantID.DIV_SAVE_LEAD_LOADER, constantID.DIV_LEAD_BUTTON_CONTAINER); $("#btnSaveLead").trigger("click") }; if ("false" == ise.Configuration.getConfigValue("UseShippingAddressVerification") || "" == a.postalCode) return e(), !1; typeof $.fn.RealTimeAddressVerification != constants.TYPE_UNDEFINED ? $.fn.RealTimeAddressVerification.requestAddressMatch(e) : e() } function GetObjectControl(a) { return $(constants.SEP_POUND + a) } function hideProgressIndicator(a, e) { $("#" + a).fadeOut("slow", function () { $("#" + e).fadeIn("slow") }) };