var labelFadeInColor = "#999", labelFadeOutColor = "#999", _PostalCode = "", _prevPostal = "", _currentPostal = "", _prevObjectType = "", _CaptchaCounter = 1, countrySelectedIndex = 0, captchaCounter = 0; $(document).ready(function () { DisplayErrorMessagePlaceHolder(); "undefined" != typeof $("#btnContinueCheckout1") && $("#btnContinueCheckout1").click(function () { $(this).css("display", "none"); $("#place-order-button-container").fadeIn("slow") }) }); function BindAddressEngineDialogListener(a) { $("#postal-search-go").unbind("click").click(function () { var b = $("#postal-search-text").val(); SearchPostalCode("1", 1, b, a) }); $("#postal-search-viewl-all").unbind("click").click(function () { SearchPostalCode("1", 1, "", a); $("#postal-search-text").val(""); $("#postal-search-text").css("font-style", "italic"); $("#postal-search-text").css("color", "#999999") }); $("#postal-search-text").unbind("keypress").keypress(function (b) { $(this).css("font-style", "normal"); $(this).css("color", "#000000"); 13 == b.which && (b = $("#postal-search-text").val(), $("#address-section").val(), b = cleanSearchString(b), $(this).val(b), SearchPostalCode("1", 1, b, a)) }) } function SearchPostalCode(a, b, c, d) { $("#search-results").html("<div id='searching-panel'><div id='search-icon'><img src='images/ajax-loader.gif' style='width:25px;'></div><div id='search-loading-text'>" + ise.StringResource.getString("selectaddress.aspx.7") + "</div></div>"); var e = $("#" + d + "AddressControl_drpCountry").val(), g = {}; g.countryCode = e; g.postalCode = ""; g.stateCode = ""; g.searchString = c; g.exactMatch = $("#address-verifcation-search-exact-word").is(":checked"); g.pageNumber = a; AjaxCallCommon("ActionService.asmx/GetAddressList", g, function (f) { $("#search-results").html(f.d); BindSearchEngineRowListener("", d); RenderGridPagination("::::" + e + "::" + c + "::" + a, b, d); CheckIfResultPanelHasScrollbar() }, function (a) { $("#search-results").html("<div id='searching-panel'><div id='search-icon'><img src='images/ajax-loader.gif' style='width:25px;'></div><div id='search-loading-text'>" + a.d + "</div></div>") }) } function RenderGridPagination(a, b, c) { var d = $("#results-found").html(); $("#records-found").html(d + " " + $("#records-found-label").html()); d /= 100; 0 < d % 1 && (d = Math.floor(d) + 1); $("#search-pages").html("Page 1 of " + d); RenderPagesURL({ pages: d, urlMax: 10, currentPage: 1, currentIndex: b, searchAttributes: a, addressType: c }) } function RenderPagesURL(a) { var b = a.pages, c = a.urlMax, d = a.currentPage, e = a.currentIndex, g = a.searchAttributes; a = a.addressType; x = d / c; x = Math.ceil(x); pager = c * x - c; var f = "<ul id='pagination-ul'>"; 1 < e || 1 < pager ? f = f + ('<li onClick=\'PagingGetAddressList("forward", ' + b + "," + c + ', 0, 0, "' + g + '", "' + a + "\")' title='Show page 1 of " + b + "' id='first-page' >|<</li>") + ('<li onClick=\'PagingGetAddressList("backward", ' + b + "," + c + "," + (e - 1) + "," + (d - 1) + ', "' + g + '", "' + a + "\")' title='Show page " + (d - 1) + " of " + b + "' id='prev-page'><<</li>") : (f += "<li class='pages-url-disabled'>|<</li>", f += "<li class='pages-url-disabled'><<</li>"); for (var h = 1; h <= c; h++) var k = h + pager, f = h > b || 1 == b || k > b ? f + ("<li class='pages-url-disabled'>" + k + "</li>") : h == e ? f + ("<li id='page-" + h + "' class='selected-page'>" + k + "</li>") : f + ('<li onClick=\'PagingGetAddressList("forward", ' + b + "," + c + "," + (h - 1) + "," + (k - 1) + ', "' + g + '", "' + a + "\")' id='page-" + h + "' class='pages-url'>" + k + "</li>"); b <= c || k >= b ? (f += "<li class='pages-url-disabled'>>></li>", f += "<li class='pages-url-disabled'>>|</li>") : (k = b - 1, f += '<li onClick=\'PagingGetAddressList("forward", ' + b + "," + c + "," + e + "," + d + ', "' + g + '", "' + a + "\")' title='Show page " + (d + 1) + " of " + b + "' id='next-page'>>></li>", f += '<li onClick=\'PagingGetAddressList("forward", ' + b + "," + c + ", " + k % c + ", " + k + ', "' + g + '", "' + a + "\")' title='Show page " + b + " of " + b + "' id='last-page'>>|</li>"); f += "</ul>"; $("#search-result-pagination").html("<div>" + f + "</div><div class='float-right'><input type='button' value='Done' class='btn btn-primary address-dialog-done-button' onClick='CloseModalDialog(\"postal-search-engine\")'></div><div class='clear-both'></div>") } function PagingGetAddressList(a, b, c, d, e, g, f) { d >= c && (d = 0); "forward" == a ? (d++, e++) : 0 >= d && (d = c); $("#search-pages").html("Downloading Page " + e + " of " + b + ", this may take a while please wait..."); a = {}; var h = g.split("::"); a.countryCode = h[2]; a.postalCode = h[0]; a.stateCode = h[1]; a.searchString = h[3]; a.exactMatch = $("#address-verifcation-search-exact-word").is(":checked"); a.pageNumber = e; AjaxCallCommon("ActionService.asmx/GetAddressList", a, function (a) { $("#search-results").html(a.d); $("#search-pages").html("Page " + e + " of " + b); BindSearchEngineRowListener("", f); CheckIfResultPanelHasScrollbar(); RenderPagesURL({ pages: b, urlMax: c, currentPage: e, currentIndex: d, searchAttributes: g, addressType: f }) }, function (a) { $("#search-results").html("<div id='searching-panel'><div id='search-icon'><img src='images/ajax-loader.gif' style='width:25px;'></div><div id='search-loading-text'>" + a.d + "</div></div>") }) } function BindSearchEngineRowListener(a, b) { $(".list-row").hover(function () { var a = $(this).index(); $(".item-" + a + "-postal-code").addClass("hoverStyle"); $(".item-" + a + "-city").addClass("hoverStyle"); $(".item-" + a + "-country-code").addClass("hoverStyle"); $(".item-" + a + "-county").addClass("hoverStyle"); $(".item-" + a + "-state-code").addClass("hoverStyle") }, function () { var a = $(this).index(); $(".item-" + a + "-postal-code").removeClass("hoverStyle"); $(".item-" + a + "-city").removeClass("hoverStyle"); $(".item-" + a + "-country-code").removeClass("hoverStyle"); $(".item-" + a + "-county").removeClass("hoverStyle"); $(".item-" + a + "-state-code").removeClass("hoverStyle") }); $(".list-row").unbind("click").click(function () { var c = $(this).index(); $(".selected-row").removeClass("selected-row"); $(".item-" + c + "-postal-code").removeClass("hoverStyle").addClass("selected-row"); $(".item-" + c + "-city").removeClass("hoverStyle").addClass("selected-row"); $(".item-" + c + "-country-code").removeClass("hoverStyle").addClass("selected-row"); $(".item-" + c + "-county").removeClass("hoverStyle").addClass("selected-row"); $(".item-" + c + "-state-code").removeClass("hoverStyle").addClass("selected-row"); var d = $(".item-" + c + "-postal-code").html(), c = $(".item-" + c + "-city").html(); UpdateAddressControlInputs({ addressType: b, isWithStates: a, postalCode: d, city: c }) }); $(".list-row").unbind("dblclick").dblclick(function () { $("#postal-search-engine").dialog("destroy") }) } function CloseModalDialog(a) { $("#" + a).dialog("close") } function ShowPostalSearchEngineDialog(a) { var b = a.country, c = a.page, d = $("#search-results"); $("#postal-search-engine").dialog({ autoOpen: !1, width: 651, modal: !0, resize: !1 }).dialog("open"); $("#postal-search-text").val("").focus(); $(".ui-dialog-buttonpane").append("<div id='search-result-pagination'></div>"); d.html("<div id='searching-panel'><div id='search-icon'><img src='images/ajax-loader.gif' style='width:25px;'></div><div id='search-loading-text'>" + ise.StringResource.getString("selectaddress.aspx.7") + "</div></div>"); var e = {}; e.countryCode = b; e.postalCode = ""; e.stateCode = ""; e.searchString = ""; e.exactMatch = !1; e.pageNumber = c; AjaxCallCommon("ActionService.asmx/GetAddressList", e, function (e) { d.html(e.d); BindSearchEngineRowListener("", a.addressType); RenderGridPagination("::::" + b + "::::" + c, 1, a.addressType); e = $("#results-state-country").html(); $("#state-country").html(e); CheckIfResultPanelHasScrollbar() }, function (a) { d.html("<div id='searching-panel'><div id='search-icon'><img src='images/ajax-loader.gif' style='width:25px;'></div><div id='search-loading-text'>" + a.d + "</div></div>") }) } function UpdateAddressControlInputs(a) { var b = a.addressType; $cityInputBox = $("#" + b + "AddressControl_txtCity"); $cityLabel = $("#" + b + "AddressControl_lblCity"); $postalInputBox = $("#" + b + "AddressControl_txtPostal"); $postalLabel = $("#" + b + "AddressControl_lblPostal"); $stateInputBox = $("#" + b + "AddressControl_txtState"); $stateLabel = $("#" + b + "AddressControl_lblState"); $cityInputBox.val(a.city).removeClass("required-input"); $cityLabel.addClass("display-none"); $postalInputBox.val(a.postalCode).removeClass("invalid-postal").removeClass("required-input").removeClass("invalid-postal-many").removeClass("invalid-postal-zero").addClass("postal-is-corrected").removeClass("undefined-city-states"); $postalLabel.addClass("display-none"); a = $stateInputBox.val(); var c = $(".selected-row").parent("div").attr("data-stateCode"); "undefined" != typeof a && ($stateInputBox.removeClass("state-not-found").removeClass("required-input").val(""), "" != c ? ($stateLabel.addClass("display-none"), $stateInputBox.val($.trim(c))) : $stateLabel.removeClass("display-none")); $("#ise-message-tips").fadeOut("slow"); HideCityStatesDropdownSelector(b) } function CheckIfResultPanelHasScrollbar() { for (var a = $("#search-results").get(0).scrollHeight, b = $("#search-results").get(0).clientHeight, c = $("#results-found").html(), d = 0; d <= c; d++) a <= b && $(".item-" + d + "-state-code").css("width", "260px") } function cleanSearchString(a) { a = $.trim(a); a = a.replace(/[\+\-\s,]/g, " "); a = a.replace(/\s+/g, " "); return a = a.replace(/[\^\$\'\"\|\{\}\=\)\(\.*\!\@\%\&\;\:\#\.\?]/g, "") } function trim(a, b) { return ltrim(rtrim(a, b), b) } function ltrim(a, b) { return a.replace(RegExp("^[" + (b || "\\s") + "]+", "g"), "") } function rtrim(a, b) { return a.replace(RegExp("[" + (b || "\\s") + "]+$", "g"), "") } function doAddressVerificationAfterSubmit() { var a = $("#ctrlBillingAddress_WithStateState").val(), b = $("#ctrlShippingAddress_WithStateState").val(); null != a && "" != a || $("#ctrlBillingAddress_WithStateState").css("display", "none"); null != b && "" != b || $("#ctrlShippingAddress_WithStateState").css("display", "none"); $("#hidCheck").val(); $("#hidBillTitle").val(); $("#hidShipTitle").val(); $("#hidBillCheck").val(); $("#hidShipCheck").val(); $("#hidBilling").val(); $("#hidShipping").val(); var c = $("#hidBillCtrl").val().split("*"); "True" == $("#hidBlnWithState").val() ? (a = document.getElementById(c[0]), b = document.getElementById(c[1])) : (a = document.getElementById(c[3]), b = document.getElementById(c[4])); var c = document.getElementById(c[2]), d = document.getElementById("hidShipCtrl").value.split("*"); if ("True" == $("#hidShpWithState").val()) var e = document.getElementById(d[0]), g = document.getElementById(d[1]); else e = document.getElementById(d[3]), g = document.getElementById(d[4]); d = document.getElementById(d[2]); "True" == $("#chkAddrInfo").val() && null != c && (d.value = c.value, e.value = a.value, g.value = b.value); a = $("#hidValid").val(); if (null != a && "false" == a) for (a = getControlIdsToCheckAfterSubmit(), b = 0; b < a.length; b++) recheckPostalAfterSubmit(a[b], "", "") } function FindPostal(a) { var b = { country: $("#" + a + "AddressControl_drpCountry").val(), addressType: a, page: 1 }; ShowPostalSearchEngineDialog(b); BindAddressEngineDialogListener(a) } function DisplayErrorMessagePlaceHolder() { 0 < $("#errorSummary_Board_Errors").children("li").length && ($("#errorSummary").slideDown("slow", function () { }), $("#error-summary-clear").fadeIn("fast")) } function IsRequiredInformationAllGood() { var a = 0, b = !0, c = !1; $(".requires-validation").each(function () { var d = $(this); c = !1; if ("disabled" == d.attr("disabled") || IsPostalInputBoxOptional(d.attr("id"))) c = !0; "" == d.val() && !1 == c && (d.removeClass("current-object-on-focus").addClass("required-input"), 0 == a && d.addClass("current-object-on-focus").focus(), a++, b = !1) }); return b } function SkipValidationOnPostal(a, b) { var c = $("#" + a + "AddressControl_txtCity"), d = $("#" + a + "AddressControl_txtPostal"), e = $("#" + a + "AddressControl_txtState"); d.addClass("skip"); d.removeClass("invalid-postal").removeClass("invalid-postal-zero").removeClass("required-input").removeClass("invalid-postal-many").removeClass("invalid-postal-zero").removeClass("undefined-city-states"); var g = $.trim(c.val()), f = $.trim(e.val()), h = $.trim(d.val()); "" == g && (c.val("").removeClass("required-input"), $("#" + a + "AddressControl_lblCity").removeClass("display-none")); "" == f && (e.removeClass("required-input").val(""), $("#" + a + "AddressControl_lblState").removeClass("display-none")); "" == h && (d.removeClass("required-input").val(""), $("#" + a + "AddressControl_lblState").removeClass("display-none")); e.removeClass("state-not-found").addClass("skip").removeAttr("disabled").removeClass("display-none").removeClass("control-disabled"); c.removeClass("city-width-if-no-state"); HideStateInputBoxForCountryWithState(a + "AddressControl"); "" != a && (a += "-"); $("#" + a.toLowerCase() + "enter-postal-label-place-holder").html("<input type='hidden' id='" + a.toLowerCase() + "city-states' value='other'/>"); $("." + a.toLowerCase() + "zip-city-other-place-holder").fadeIn("Slow"); $("#ise-message-tips").fadeOut("slow"); b && c.focus() } function HideCityStatesDropdownSelector(a) { "undefined" != typeof a && "" != a && (a = a.toLowerCase() + "-"); $("#" + a + "enter-postal-label-place-holder").html("<input type='hidden' id='" + a + "city-states' value='other'/>"); $("#" + a + "city-states").fadeOut("Slow", function () { $("." + a + "zip-city-other-place-holder").fadeIn("Slow") }) };