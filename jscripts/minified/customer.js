var appConfigs = { IS_CAPTCHA_REQUIRED: !1, IS_SHOW_SHIPPING: !1, IS_SHOW_TAX: !1, IS_VAT_ENABLED: !1, IS_HAS_AGE_REQUIREMENT: !1, IS_REQUIRE_STRONG_PASSWORD: !1, REG_EX_STRONG_PASSWORD: "", IS_GET_ADDRESS_MATCH: !1 }, constants = { CONTROL_DISABLED: "control-disabled", DISPLAY_NONE: "display-none", WIDTH_NO_STATE: "city-width-if-no-state", WIDTH_ENTER_POSTAL: "enter-postal-message-width", EMPTY: "", SEP_SPACE: " ", SEP_POUND: "#", SET_DOT: ".", TYPE_WHOLESALE: "wholesale", TYPE_SIGNUP: "signup", TYPE_PROFILE: "profile", TYPE_ADDRESS: "address", TYPE_UNDEFINED: "undefined", TYPE_OTHER: "other", ON_FOCUS: "current-object-on-focus" }, constantErrorTags = { POSTAL_NOT_FOUND: "invalid-postal-zero", INVALID_EMAIL: "invalid-email", INVALID_POSTAL: "invalid-postal", STATE_NOT_FOUND: "state-not-found", REQUIRED_INPUT: "required-input", PASSWORD_NOT_MATCH: " password-not-match", PASSWORD_NOT_STRONG: "password-not-strong", PASSWORD_LENGTH_INVALID: "password-length-invalid" }, constantID = { BTN_CAPTCHA_REFRESH: "#captcha-refresh-button", BTN_SIGNUP: "#create-customer-account", BTN_HIDDEN_SIGNUP: "#btnCreateAccount", BTN_UPDATE_ADDRESS: "#btnUpdateAddress", BTN_ADD_ADDRESS: "#btnNewAddress", CHK_SAME_AS_BILLING: "#copyBillingInfo", CHK_IS_WITH_REQUIRED_AGE: "#chkOver13", DIV_SHIPPING_SECTION_HEADER: "#shipping-section-head-place-holder", DIV_SHIPPING_SECTION_INFO: "#shipping-info-place-holder", DIV_MESSAGE_TIPS: "#ise-message-tips", DIV_REQUIRED_AGE: "#age-13-place-holder", DIV_ENTER_POSTAL: "#enter-postal-label-place-holder", DIV_BILLING_ENTER_POSTAL: "#billing-enter-postal-label-place-holder", DIV_SHIPPING_ENTER_POSTAL: "#shipping-enter-postal-label-place-holder", DIV_SAVE_ACCOUNT_LOADER: "save-account-loader", DIV_SAVE_ACCOUNT_BUTTON_CONTAINER: "save-account-button-place-holder", DIV_UPDATE_ADDRESS_LOADER: "update-address-loader", DIV_UPDATE_ADDRESS_BUTTON_CONTAINER: "update-address-button-place-holder", DRP_ADDRESS_TYPE: "#ShippingAddressControl_drpType", DRP_BUSINESS_TYPE: "#BillingAddressControl_drpBusinessType", INPUT_ACCOUNT_NAME: "#ProfileControl_txtAccountName", INPUT_CAPTCHA: "#txtCaptcha", INPUT_TAX_NUMBER: "#tax-number-place-holder" }, profileConstantID = { CHK_IS_OKTOEMAIL: "chkIsOkToEmail", CHK_IS_OVER13CHECKED: "chkIsOver13Checked", DIV_ERROR_PLACEHOLDER: "profile-error-place-holder", DIV_SAVE_PROGRESS_PLACEHOLDER: "save-profile-loader", DIV_SAVE_BUTTON_PLACEHOLDER: "save-profile-button-place-holder", DRP_SALUTATION: "ProfileControl_drpLstSalutation", INPUT_CAPTCHA: "txtCaptcha", INPUT_EMAIL: "ProfileControl_txtEmail", INPUT_ANONYMOUS_EMAIL: "ProfileControl_txtAnonymousEmail", INPUT_FIRSTNAME: "ProfileControl_txtFirstName", INPUT_LASTNAME: "ProfileControl_txtLastName", INPUT_CONTACT_NUMBER: "ProfileControl_txtContactNumber", INPUT_ACCOUNT_NAME: "ProfileControl_txtAccountName", INPUT_PASSWORD: "ProfileControl_txtPassword", INPUT_CONFIRM_PASSWORD: "ProfileControl_txtConfirmPassword", INPUT_MOBILE: "ProfileControl_txtMobile", INPUT_OLD_PASSWORD: "old-password-input", LABEL_FIRSTNAME: "lblFirstName", LABEL_LASTNAME: "lblLastName", LABEL_EMAIL: "lblEmail", LABEL_ANONYMOUS_EMAIL: "lblAnonymousEmail", LABEL_CONTACT_NUMBER: "lblContactNumber", LABEL_ACCOUNT_NAME: "lblAccountName", LABEL_CONFIRM_PASSWORD: "lblConfirmPassword", LABEL_MOBILE: "lblMobile", LINK_RESET_SIGN_UP_FORM: "linkResetSignUpForm" }, addressConstantID = { CHK_SAME_AS_BILLING: "copyBillingInfo", DIV_TAX_NUMBER: "tax-number-place-holder", DRP_SHIPPING_ADDRESS_TYPE: "ShippingAddressControl_drpType", DRP_BILLING_BUSINESS_TYPE: "BillingAddressControl_drpBusinessType", DRP_COUNTRY: "AddressControl_drpCountry", DRP_BILLING_COUNTRY: "BillingAddressControl_drpCountry", DRP_SHIPPING_COUNTRY: "ShippingAddressControl_drpCountry", HIDDEN_CITYSTATE: "city-states", HIDDEN_BILLING_CITYSTATE: "billing-city-states", HIDDEN_SHIPPING_CITYSTATE: "shipping-city-states", LABEL_STREET: "AddressControl_lblStreet", LABEL_POSTAL: "AddressControl_lblPostal", LABEL_CITY: "AddressControl_lblCity", LABEL_STATE: "AddressControl_lblState", LABEL_COUNTY: "AddressControl_lblCounty", LABEL_BILLING_STREET: "BillingAddressControl_lblStreet", LABEL_BILLING_POSTAL: "BillingAddressControl_lblPostal", LABEL_BILLING_CITY: "BillingAddressControl_lblCity", LABEL_BILLING_STATE: "BillingAddressControl_lblState", LABEL_BILLING_COUNTY: "BillingAddressControl_lblCounty", LABEL_SHIPPING_STREET: "ShippingAddressControl_lblStreet", LABEL_SHIPPING_POSTAL: "ShippingAddressControl_lblPostal", LABEL_SHIPPING_CITY: "ShippingAddressControl_lblCity", LABEL_SHIPPING_STATE: "ShippingAddressControl_lblState", LABEL_SHIPPING_COUNTY: "ShippingAddressControl_lblCounty", INPUT_STREET: "AddressControl_txtStreet", INPUT_POSTAL: "AddressControl_txtPostal", INPUT_CITY: "AddressControl_txtCity", INPUT_STATE: "AddressControl_txtState", INPUT_COUNTY: "AddressControl_txtCounty", INPUT_BILLING_STREET: "BillingAddressControl_txtStreet", INPUT_BILLING_POSTAL: "BillingAddressControl_txtPostal", INPUT_BILLING_CITY: "BillingAddressControl_txtCity", INPUT_BILLING_STATE: "BillingAddressControl_txtState", INPUT_BILLING_COUNTY: "BillingAddressControl_txtCounty", INPUT_SHIPPING_STREET: "ShippingAddressControl_txtStreet", INPUT_SHIPPING_POSTAL: "ShippingAddressControl_txtPostal", INPUT_SHIPPING_CITY: "ShippingAddressControl_txtCity", INPUT_SHIPPING_STATE: "ShippingAddressControl_txtState", INPUT_SHIPPING_COUNTY: "ShippingAddressControl_txtCounty" }, serviceMethods = { UPDATE_ACCOUNTINFO: "UpdateAccountInfo" }; $(document).ready(function () { switch ($("#load-at-page").val()) { case "create-account": LoadCustomerRequiredStringResources(constants.TYPE_SIGNUP); var a; LoadCustmerRequiredAppConfiguration(constants.TYPE_SIGNUP, function () { appConfigs.IS_CAPTCHA_REQUIRED = "true" == ise.Configuration.getConfigValue("SecurityCodeRequiredOnCreateAccount") || "true" == ise.Configuration.getConfigValue("SecurityCodeRequiredOnCreateAccountDuringCheckout"); appConfigs.IS_SHOW_SHIPPING = "true" == ise.Configuration.getConfigValue("AllowShipToDifferentThanBillTo"); appConfigs.IS_SHOW_TAX = "true" == ise.Configuration.getConfigValue("VAT.ShowTaxFieldOnRegistration"); appConfigs.IS_VAT_ENABLED = "true" == ise.Configuration.getConfigValue("VAT.Enabled"); appConfigs.IS_HAS_AGE_REQUIREMENT = "true" == ise.Configuration.getConfigValue("RequireOver13Checked"); appConfigs.IS_REQUIRE_STRONG_PASSWORD = "true" == ise.Configuration.getConfigValue("UseStrongPwd"); appConfigs.REG_EX_STRONG_PASSWORD = ise.Configuration.getConfigValue("CustomerPwdValidator"); appConfigs.IS_GET_ADDRESS_MATCH = "true" == ise.Configuration.getConfigValue("UseShippingAddressVerification"); InitSignUpForm(); AjaxSecureEmailAddressVerification(!0, constants.EMPTY, constants.EMPTY, function (a) { }, function (a) { }) }); BindBubbleMessagePluginToSignUpForm(); BindSignUpFormEventsListener(); break; case "edit-profile": LoadCustomerRequiredStringResources(constants.TYPE_PROFILE); LoadCustmerRequiredAppConfiguration(constants.TYPE_PROFILE, function () { appConfigs.IS_CAPTCHA_REQUIRED = "true" == ise.Configuration.getConfigValue("SecurityCodeRequiredOnCreateAccount"); appConfigs.IS_REQUIRE_STRONG_PASSWORD = "true" == ise.Configuration.getConfigValue("UseStrongPwd"); appConfigs.REG_EX_STRONG_PASSWORD = ise.Configuration.getConfigValue("CustomerPwdValidator"); InitProfileForm(); AjaxSecureEmailAddressVerification(!0, constants.EMPTY, constants.EMPTY, function (a) { }, function (a) { }) }); BindProfileFormEventsListener(); break; case "select-address": LoadCustomerRequiredStringResources(constants.TYPE_ADDRESS); a = function (a) { appConfigs.IS_GET_ADDRESS_MATCH = "true" == ise.Configuration.getConfigValue("UseShippingAddressVerification") }; LoadCustmerRequiredAppConfiguration(constants.TYPE_ADDRESS, a); "true" == getQueryString().add && (BindAddressControlEventsListener(!0), BindBubbleMessagePluginToAddressControl()); break; case "edit-address": LoadCustomerRequiredStringResources(constants.TYPE_ADDRESS), a = function (a) { appConfigs.IS_GET_ADDRESS_MATCH = "true" == ise.Configuration.getConfigValue("UseShippingAddressVerification") }, LoadCustmerRequiredAppConfiguration(constants.TYPE_ADDRESS, a), BindAddressControlEventsListener(!1), BindBubbleMessagePluginToAddressControl() } }); function InitSignUpForm() { appConfigs.IS_CAPTCHA_REQUIRED && ($(".captcha-section").fadeIn("slow"), $(constantID.INPUT_CAPTCHA).ISEBubbleMessage({ "input-id": "txtCaptcha", "label-id": "lblCaptcha" })); !1 == appConfigs.IS_SHOW_SHIPPING && ($(constantID.DIV_SHIPPING_SECTION_HEADER).html(constants.EMPTY), $(constantID.DIV_SHIPPING_SECTION_INFO).html(constants.EMPTY), $(".shipping-section-clears").addClass(constants.DISPLAY_NONE)); $(constantID.CHK_SAME_AS_BILLING).click(function () { CopyBillingInformation($(this).is(":checked")) }); $(constantID.CHK_IS_WITH_REQUIRED_AGE).click(function () { $(this).is(":checked") && ($(constantID.DIV_MESSAGE_TIPS).fadeOut("slow"), $(constantID.DIV_REQUIRED_AGE).removeClass(constantErrorTags.REQUIRED_INPUT)) }); var a = GetInputValue(addressConstantID.DRP_BILLING_BUSINESS_TYPE); ConvertStringToLower(a) == constants.TYPE_WHOLESALE && ShowElement(addressConstantID.DIV_TAX_NUMBER) } function BindSignUpFormEventsListener() { var a = $(constantID.DIV_MESSAGE_TIPS); $(constantID.BTN_SIGNUP).click(function () { ValidateSignUpForm() }); $(constantID.BTN_CAPTCHA_REFRESH).click(function () { captchaCounter++; $("#captcha").attr("src", "Captcha.ashx?id=" + captchaCounter) }); var b = GetObjectControl(profileConstantID.INPUT_PASSWORD), c = GetObjectControl(profileConstantID.INPUT_CONFIRM_PASSWORD); b.keyup(function () { var a = $(this); a.val() == constants.EMPTY && (ShowElement(profileConstantID.LABEL_CONFIRM_PASSWORD), c.removeClass(constantErrorTags.PASSWORD_NOT_MATCH).removeClass(constantErrorTags.REQUIRED_INPUT).val(constants.EMPTY), a.removeClass(constantErrorTags.PASSWORD_NOT_STRONG)) }); c.keyup(function () { trimString($(this).val()) == constants.EMPTY && b.removeClass(constantErrorTags.PASSWORD_NOT_MATCH).removeClass(constantErrorTags.PASSWORD_NOT_STRONG).removeClass(constantErrorTags.PASSWORD_LENGTH_INVALID).removeClass(constantErrorTags.REQUIRED_INPUT) }); $(constantID.DRP_ADDRESS_TYPE).change(function () { $(this).removeClass(constantErrorTags.REQUIRED_INPUT); a.fadeOut("slow") }); var e = GetObjectControl(addressConstantID.DIV_TAX_NUMBER); $(constantID.DRP_BUSINESS_TYPE).change(function () { var b = $(this); b.removeClass(constantErrorTags.REQUIRED_INPUT); a.fadeOut("slow"); var b = ConvertStringToLower(b.val()), c = ConvertStringToLower(ise.StringResource.getString("createaccount.aspx.79")); b == c ? (ShowElement(addressConstantID.DIV_TAX_NUMBER), e.fadeIn("slow")) : e.fadeOut("slow") }); $firstNameInputBox = GetObjectControl(profileConstantID.INPUT_FIRSTNAME); $lastNameInputBox = GetObjectControl(profileConstantID.INPUT_LASTNAME); $accountNameInputBox = GetObjectControl(profileConstantID.INPUT_ACCOUNT_NAME); $accountNameLabel = GetObjectControl(profileConstantID.LABEL_ACCOUNT_NAME); $firstNameInputBox.blur(function () { var a = trimString($(this).val()), b = trimString($lastNameInputBox.val()); a != constants.EMPTY && b != constants.EMPTY && (HideElement(profileConstantID.LABEL_ACCOUNT_NAME), $accountNameInputBox.removeClass(constantErrorTags.REQUIRED_INPUT).val(a + constants.SEP_SPACE + b)) }); $lastNameInputBox.blur(function () { var a = trimString($firstNameInputBox.val()), b = trimString($(this).val()); a != constants.EMPTY && b != constants.EMPTY && (HideElement(profileConstantID.LABEL_ACCOUNT_NAME), $accountNameInputBox.removeClass(constantErrorTags.REQUIRED_INPUT).val(a + constants.SEP_SPACE + b)) }); $linkFormReset = GetObjectControl(profileConstantID.LINK_RESET_SIGN_UP_FORM); $linkFormReset.click(function () { ResetSignUpForm() }); ReturnFalseOnEnter() } function ResetSignUpForm() { GetObjectControl(profileConstantID.INPUT_FIRSTNAME).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(profileConstantID.LABEL_FIRSTNAME); GetObjectControl(profileConstantID.INPUT_LASTNAME).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(profileConstantID.LABEL_LASTNAME); typeof GetObjectControl(profileConstantID.INPUT_EMAIL).val() != constants.TYPE_UNDEFINED && (GetObjectControl(profileConstantID.INPUT_EMAIL).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT).removeClass(constantErrorTags.INVALID_EMAIL), ShowElement(profileConstantID.LABEL_EMAIL)); typeof GetObjectControl(profileConstantID.INPUT_ANONYMOUS_EMAIL).val() != constants.TYPE_UNDEFINED && (GetObjectControl(profileConstantID.INPUT_ANONYMOUS_EMAIL).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT).removeClass(constantErrorTags.INVALID_EMAIL), ShowElement(profileConstantID.LABEL_ANONYMOUS_EMAIL)); GetObjectControl(profileConstantID.INPUT_CONTACT_NUMBER).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(profileConstantID.LABEL_CONTACT_NUMBER); GetObjectControl(addressConstantID.INPUT_BILLING_STREET).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_BILLING_STREET); GetObjectControl(addressConstantID.INPUT_BILLING_CITY).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_BILLING_CITY); GetObjectControl(addressConstantID.INPUT_BILLING_STATE).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_BILLING_STATE); GetObjectControl(addressConstantID.INPUT_BILLING_POSTAL).val(constants.EMPTY).trigger("blur").removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_BILLING_POSTAL); GetObjectControl(addressConstantID.INPUT_SHIPPING_STREET).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_SHIPPING_STREET); GetObjectControl(addressConstantID.INPUT_SHIPPING_CITY).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_SHIPPING_CITY); GetObjectControl(addressConstantID.INPUT_SHIPPING_STATE).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_SHIPPING_STATE); GetObjectControl(addressConstantID.INPUT_SHIPPING_POSTAL).val(constants.EMPTY).trigger("blur").removeClass(constantErrorTags.REQUIRED_INPUT); ShowElement(addressConstantID.LABEL_SHIPPING_POSTAL); GetObjectControl(addressConstantID.CHK_SAME_AS_BILLING).removeAttr("checked"); GetObjectControl(addressConstantID.DRP_BILLING_BUSINESS_TYPE).val(GetDropdownListFirstOption(addressConstantID.DRP_BILLING_BUSINESS_TYPE)); GetObjectControl(addressConstantID.DRP_SHIPPING_ADDRESS_TYPE).val(GetDropdownListFirstOption(addressConstantID.DRP_SHIPPING_ADDRESS_TYPE)); GetObjectControl(addressConstantID.DRP_BILLING_COUNTRY).val(GetDropdownListFirstOption(addressConstantID.DRP_BILLING_COUNTRY)); GetObjectControl(addressConstantID.DRP_SHIPPING_COUNTRY).val(GetDropdownListFirstOption(addressConstantID.DRP_SHIPPING_COUNTRY)); CopyBillingInformation(!1); GetObjectControl(profileConstantID.INPUT_CAPTCHA).val(constants.EMPTY).removeClass(constantErrorTags.REQUIRED_INPUT) } function GetDropdownListFirstOption(a) { return $.trim($(constants.SEP_POUND + a + " option:first").val()) } function ReturnFalseOnEnter() { GetObjectControl(profileConstantID.INPUT_EMAIL).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_ANONYMOUS_EMAIL).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_FIRSTNAME).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_LASTNAME).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_CONTACT_NUMBER).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_ACCOUNT_NAME).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_PASSWORD).keypress(function (a) { return enterEvent(a) }); GetObjectControl(profileConstantID.INPUT_CONFIRM_PASSWORD).keypress(function (a) { return enterEvent(a) }) } function enterEvent(a) { if (13 == a.which) return !1 } function IsPasswordStrong(a) { if (!1 == appConfigs.IS_REQUIRE_STRONG_PASSWORD) return !0; var b = appConfigs.REG_EX_STRONG_PASSWORD; if (b == constants.EMPTY) return !1; a = $("#" + a).val(); a = $.trim(a); return a.match(b) } function ValidatePassword(a) { var b = GetObjectControl(a), c = GetObjectControl(profileConstantID.INPUT_CONFIRM_PASSWORD), e = GetInputValue(a); if (typeof e == constants.TYPE_UNDEFINED) return !0; var d = !0, d = IsPasswordStrong(a); if (e.length < parseInt(ise.Configuration.getConfigValue("PasswordMinLength"))) return b.addClass(constantErrorTags.PASSWORD_LENGTH_INVALID), !1; if (d) { if (b.removeClass(constantErrorTags.PASSWORD_NOT_STRONG), a = GetInputValue(profileConstantID.INPUT_CONFIRM_PASSWORD), e != constants.EMPTY && a != constants.EMPTY) { if (e != a) return b.addClass(constantErrorTags.PASSWORD_NOT_MATCH), c.addClass(constantErrorTags.PASSWORD_NOT_MATCH), !1; b.removeClass(constantErrorTags.PASSWORD_NOT_MATCH); c.removeClass(constantErrorTags.PASSWORD_NOT_MATCH) } } else return b.addClass(constantErrorTags.PASSWORD_NOT_STRONG), !1; return !0 } function CopyBillingInformation(a) { var b = GetObjectControl(addressConstantID.DRP_SHIPPING_COUNTRY), c = GetObjectControl(addressConstantID.INPUT_SHIPPING_STREET), e = GetObjectControl(addressConstantID.INPUT_SHIPPING_POSTAL), d = GetObjectControl(addressConstantID.INPUT_SHIPPING_STATE), f = GetObjectControl(addressConstantID.INPUT_SHIPPING_CITY), g = GetObjectControl(addressConstantID.INPUT_SHIPPING_COUNTY); c.removeClass(constantErrorTags.REQUIRED_INPUT); e.removeClass(constantErrorTags.REQUIRED_INPUT).removeClass(constantErrorTags.INVALID_POSTAL); d.removeClass(constantErrorTags.REQUIRED_INPUT).removeClass(constantErrorTags.STATE_NOT_FOUND); f.removeClass(constantErrorTags.REQUIRED_INPUT); g.removeClass(constantErrorTags.REQUIRED_INPUT); if (a) { a = GetInputValue(addressConstantID.DRP_BILLING_COUNTRY); var h = GetInputValue(addressConstantID.HIDDEN_BILLING_CITYSTATE), k = constants.EMPTY, l = constants.EMPTY; typeof h == constants.TYPE_UNDEFINED || h == constants.TYPE_OTHER ? (k = GetInputValue(addressConstantID.INPUT_BILLING_CITY), l = GetInputValue(addressConstantID.INPUT_BILLING_STATE)) : (h = h.split(", "), 1 < h.length ? (k = $.trim(h[1]), l = $.trim(h[0])) : (k = $.trim(h[0]), l = constants.EMPTY)); typeof k == constants.TYPE_UNDEFINED && (k = constants.EMPTY); typeof l == constants.TYPE_UNDEFINED && (l = constants.EMPTY); c.val(GetInputValue(addressConstantID.INPUT_BILLING_STREET)); e.val(GetInputValue(addressConstantID.INPUT_BILLING_POSTAL)); f.val(k); d.val(l); b.val(a); b = GetInputValue(addressConstantID.INPUT_BILLING_COUNTY); typeof b != constants.TYPE_UNDEFINED && b != constants.EMPTY && g.val(b); $(constantID.DIV_MESSAGE_TIPS).fadeOut("slow"); DisableShippingControl(!0) } else DisableShippingControl(!1); IsWithStates(addressConstantID.DRP_BILLING_COUNTRY) ? (f.removeClass(constants.WIDTH_NO_STATE), d.fadeIn("slow")) : d.fadeOut("slow", function () { HideElement(addressConstantID.LABEL_SHIPPING_STATE); f.addClass(constants.WIDTH_NO_STATE) }) } function DisableShippingControl(a) { var b = GetObjectControl(addressConstantID.DRP_SHIPPING_COUNTRY), c = GetObjectControl(addressConstantID.INPUT_SHIPPING_STREET), e = GetObjectControl(addressConstantID.INPUT_SHIPPING_POSTAL), d = GetObjectControl(addressConstantID.INPUT_SHIPPING_STATE), f = GetObjectControl(addressConstantID.INPUT_SHIPPING_CITY), g = GetObjectControl(addressConstantID.INPUT_SHIPPING_COUNTY); a ? (HideElement(addressConstantID.LABEL_SHIPPING_STREET), HideElement(addressConstantID.LABEL_SHIPPING_STATE), HideElement(addressConstantID.LABEL_SHIPPING_CITY), HideElement(addressConstantID.LABEL_SHIPPING_POSTAL), HideElement(addressConstantID.LABEL_BILLING_STATE), HideElement(addressConstantID.LABEL_COUNTY), c.addClass(constants.CONTROL_DISABLED).attr("disabled", "disabled"), e.addClass(constants.CONTROL_DISABLED).attr("disabled", "disabled"), f.addClass(constants.CONTROL_DISABLED).attr("disabled", "disabled"), d.addClass(constants.CONTROL_DISABLED).attr("disabled", "disabled"), g.addClass(constants.CONTROL_DISABLED).attr("disabled", "disabled"), b.css("background", "#ccc").attr("disabled", "disabled"), $(constantID.DIV_SHIPPING_ENTER_POSTAL).removeClass(constants.WIDTH_ENTER_POSTAL).html("<input type='hidden' id='shipping-city-states' value='other'/>"), GetObjectControl(addressConstantID.HIDDEN_SHIPPING_CITYSTATE).fadeOut("Slow", function () { $(".shipping-zip-city-other-place-holder").fadeIn("Slow") })) : (c.removeClass(constants.CONTROL_DISABLED).removeAttr("disabled"), e.removeClass(constants.CONTROL_DISABLED).removeAttr("disabled"), f.removeClass(constants.CONTROL_DISABLED).removeAttr("disabled", "disabled"), d.removeClass(constants.CONTROL_DISABLED).removeAttr("disabled"), g.removeClass(constants.CONTROL_DISABLED).removeAttr("disabled"), b.css("background", "#fff").removeAttr("disabled")) } function ValidateSignUpForm() { $divMessageTips = $(constantID.DIV_MESSAGE_TIPS); $businessTypeSelector = GetObjectControl(addressConstantID.DRP_BILLING_BUSINESS_TYPE); $addressTypeSelector = GetObjectControl(addressConstantID.DRP_SHIPPING_ADDRESS_TYPE); $billingPostalInputBox = GetObjectControl(addressConstantID.INPUT_BILLING_POSTAL); $shippingPostalInputBox = GetObjectControl(addressConstantID.INPUT_SHIPPING_POSTAL); $divMessageTips.fadeOut("slow"); var a = 0, b = !1, c = !1, e = IsElementChecked("copyBillingInfo"); $(".requires-validation").each(function () { var d = $(this), f = $.trim(d.val()), g = d.attr("id"), g = $.trim(g); if ("" == f) { c = !1; if (g == addressConstantID.INPUT_BILLING_CITY || g == addressConstantID.INPUT_BILLING_STATE) c = IsElementHidden(".billing-zip-city-other-place-holder"); g == addressConstantID.INPUT_BILLING_STATE && !1 == c && (c = !1 == IsWithStates(addressConstantID.DRP_BILLING_COUNTRY)); if (appConfigs.IS_SHOW_SHIPPING) { if (g == addressConstantID.INPUT_SHIPPING_CITY || g == addressConstantID.INPUT_SHIPPING_STATE) c = IsElementHidden(".shipping-zip-city-other-place-holder"); g == addressConstantID.INPUT_SHIPPING_STATE && !1 == c && (c = !1 == IsWithStates(addressConstantID.DRP_SHIPPING_COUNTRY) || e) } IsPostalInputBoxOptional(g) && (c = !0); IsInArray([addressConstantID.INPUT_SHIPPING_STREET, addressConstantID.INPUT_SHIPPING_CITY, addressConstantID.INPUT_SHIPPING_STATE, addressConstantID.INPUT_SHIPPING_POSTAL], g) && e && (c = !0); !1 == c && (d.removeClass(constants.ON_FOCUS).addClass(constantErrorTags.REQUIRED_INPUT), 0 == a && (d.addClass(constants.ON_FOCUS), d.focus()), b = !0, a++) } }); if (b) return !1; var d = typeof GetObjectControl(profileConstantID.INPUT_EMAIL).val() == constants.TYPE_UNDEFINED ? GetObjectControl(profileConstantID.INPUT_ANONYMOUS_EMAIL) : GetObjectControl(profileConstantID.INPUT_EMAIL); if (d.hasClass("invalid-email") || d.hasClass("email-duplicates")) return d.focus(), !1; var f = profileConstantID.INPUT_PASSWORD; if (!ValidatePassword(f) && GetInputValue(f) != constants.EMPTY) return GetObjectControl(f).focus(), !1; f = null; if (appConfigs.IS_SHOW_TAX && appConfigs.IS_VAT_ENABLED && ConvertStringToLower($businessTypeSelector.val()) == ConvertStringToLower(ise.StringResource.getString("createaccount.aspx.82"))) return SetObjectFieldAsRequired($businessTypeSelector), f = getObectPositionOffset($businessTypeSelector), showTips(f, ise.StringResource.getString("selectaddress.aspx.13")), !1; if (appConfigs.IS_SHOW_SHIPPING && ConvertStringToLower($addressTypeSelector.val()) == ConvertStringToLower(ise.StringResource.getString("selectaddress.aspx.6"))) return SetObjectFieldAsRequired($addressTypeSelector), f = getObectPositionOffset($addressTypeSelector), showTips(f, ise.StringResource.getString("selectaddress.aspx.12")), !1; if (GetInputValue(addressConstantID.HIDDEN_BILLING_CITYSTATE) == constants.EMPTY) return $billingPostalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), f = getObectPositionOffset($billingPostalInputBox), showTips(f, ise.StringResource.getString("selectaddress.aspx.11")), !1; $billingPostalInputBox.removeClass(constantErrorTags.POSTAL_NOT_FOUND); $divMessageTips.fadeOut("slow"); e && CopyBillingInformation(!0); if (appConfigs.IS_SHOW_SHIPPING && !1 == e) { if (GetInputValue(addressConstantID.HIDDEN_SHIPPING_CITYSTATE) == constants.EMPTY) return $shippingPostalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), f = getObectPositionOffset($shippingPostalInputBox), showTips(f, ise.StringResource.getString("selectaddress.aspx.11")), !1; $shippingPostalInputBox.removeClass(constantErrorTags.POSTAL_NOT_FOUND); $divMessageTips.fadeOut("slow") } f = $(constantID.DIV_MESSAGE_TIPS); if (appConfigs.IS_HAS_AGE_REQUIREMENT && !1 == $("#chkOver13").is(":checked")) { $(constantID.DIV_REQUIRED_AGE).addClass(constantErrorTags.REQUIRED_INPUT); var g = $(constantID.DIV_REQUIRED_AGE).offset().left, h = $(constantID.DIV_REQUIRED_AGE).offset().top; f.css("top", h - 47); f.css("left", g - 17); $("#ise-message").html(ise.StringResource.getString("createaccount.aspx.123")); f.fadeIn("slow"); return !1 } $(constantID.DIV_REQUIRED_AGE).removeClass(constantErrorTags.REQUIRED_INPUT); f = d.parent("span").attr("data-accountType"); f = "undefined" == typeof f ? "" : $.trim(f); g = $.trim(ise.StringResource.getString("createaccount.aspx.158")); typeof g != constants.TYPE_UNDEFINED && g != constants.EMPTY && ShowProcessMessage(g, "error-summary", constantID.DIV_SAVE_ACCOUNT_LOADER, constantID.DIV_SAVE_ACCOUNT_BUTTON_CONTAINER); AjaxSecureEmailAddressVerification(!1, d.val(), f, function (a) { a = trimString(a.d); var b = ""; if ("" != a) { switch (a) { case "email-duplicates": b = a; break; case "invalid-email": b = a; break; default: b = "ajax-request-failed" } d.addClass(b).attr("response-message", a); d.focus(); if ("ajax-request-failed" == b) VerifySignUpFormAddress_v2(); else return hideProgressIndicator(constantID.DIV_SAVE_ACCOUNT_LOADER, constantID.DIV_SAVE_ACCOUNT_BUTTON_CONTAINER), !1 } else VerifySignUpFormAddress_v2() }, function (a) { VerifySignUpFormAddress_v2() }) } function IsElementChecked(a) { return $("#" + a).is(":checked") } function IsElementHidden(a) { return "none" == $(a).css("display") } function IsUndefined(a) { return typeof a == constants.TYPE_UNDEFINED } function SetObjectFieldAsRequired(a) { a.addClass(constantErrorTags.REQUIRED_INPUT) } function getObectPositionOffset(a) { return { left: a.offset().left, top: a.offset().top } } function showTips(a, b) { $divMessageTips = $("#ise-message-tips"); $divMessageText = $("#ise-message"); $divMessageTips.css("top", a.top - 47).css("left", a.left - 17); $divMessageText.html(b); $divMessageTips.fadeIn("slow") } function BindBubbleMessagePluginToSignUpForm() { $("#BillingAddressControl_txtPostal").ISEAddressFinder(); $("#BillingAddressControl_txtStreet").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtStreet", "label-id": "BillingAddressControl_lblStreet" }); $("#BillingAddressControl_txtPostal").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtPostal", "label-id": "BillingAddressControl_lblPostal", "input-mode": "billing-postal", "address-type": "Billing" }); $("#BillingAddressControl_txtCity").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtCity", "label-id": "BillingAddressControl_lblCity" }); $("#BillingAddressControl_txtState").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtState", "label-id": "BillingAddressControl_lblState", "input-mode": "billing-state" }); $("#BillingAddressControl_txtTaxNumber").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtTaxNumber", "label-id": "BillingAddressControl_lblTaxNumber", optional: !0 }); "undefined" != typeof $("#BillingAddressControl_txtCounty").val() && $("#BillingAddressControl_txtCounty").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtCounty", "label-id": "BillingAddressControl_lblCounty", optional: !0 }); $("#ProfileControl_txtFirstName").ISEBubbleMessage({ "input-id": "ProfileControl_txtFirstName", "label-id": "lblFirstName" }); $("#ProfileControl_txtLastName").ISEBubbleMessage({ "input-id": "ProfileControl_txtLastName", "label-id": "lblLastName" }); var a = GetObjectControl(profileConstantID.INPUT_EMAIL); typeof a.val() != constants.TYPE_UNDEFINED && a.ISEBubbleMessage({ "input-id": profileConstantID.INPUT_EMAIL, "label-id": profileConstantID.LABEL_EMAIL, "input-mode": "email" }); a = GetObjectControl(profileConstantID.INPUT_ANONYMOUS_EMAIL); typeof a.val() != constants.TYPE_UNDEFINED && a.ISEBubbleMessage({ "input-id": profileConstantID.INPUT_ANONYMOUS_EMAIL, "label-id": profileConstantID.LABEL_ANONYMOUS_EMAIL, "input-mode": "email" }); $("#ProfileControl_txtContactNumber").ISEBubbleMessage({ "input-id": "ProfileControl_txtContactNumber", "label-id": "lblContactNumber" }); $("#ProfileControl_txtConfirmPassword").ISEBubbleMessage({ "input-id": "ProfileControl_txtConfirmPassword", "label-id": "lblConfirmPassword", "input-mode": "password-confirmation" }); $("#ProfileControl_txtAccountName").ISEBubbleMessage({ "input-id": "ProfileControl_txtAccountName", "label-id": "lblAccountName" }); $("#ProfileControl_txtPassword").ISEBubbleMessage({ "input-id": "ProfileControl_txtPassword", "label-id": "lblPassword", "input-mode": "password" }); $("#ProfileControl_txtMobile").ISEBubbleMessage({ "input-id": "ProfileControl_txtMobile", "label-id": "lblMobile", optional: !0 }); $("#ShippingAddressControl_txtPostal").ISEAddressFinder({ "country-id": "#ShippingAddressControl_drpCountry", "postal-id": "#ShippingAddressControl_txtPostal", "city-id": "#ShippingAddressControl_txtCity", "state-id": "#ShippingAddressControl_txtState", "city-state-place-holder": ".shipping-zip-city-other-place-holder", "enter-postal-label-place-holder": "#shipping-enter-postal-label-place-holder", "city-states-id": "shipping-city-states" }); $("#ShippingAddressControl_txtStreet").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtStreet", "label-id": "ShippingAddressControl_lblStreet" }); $("#ShippingAddressControl_txtPostal").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtPostal", "label-id": "ShippingAddressControl_lblPostal", "input-mode": "shipping-postal", "address-type": "Shipping" }); $("#ShippingAddressControl_txtCity").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtCity", "label-id": "ShippingAddressControl_lblCity" }); $("#ShippingAddressControl_txtState").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtState", "label-id": "ShippingAddressControl_lblState", "input-mode": "shipping-state" }); "undefined" != typeof $("#ShippingAddressControl_txtCounty").val() && $("#ShippingAddressControl_txtCounty").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtCounty", "label-id": "ShippingAddressControl_lblCounty", optional: !0 }); IsElementChecked("copyBillingInfo") && CopyBillingInformation(!0); GetSelectedCityState() } function GetSelectedCityState() { if ("" != $("#billingTxtCityStates").val()) { $(".billing-zip-city-other-place-holder").fadeIn("Slow"); $("#billing-enter-postal-label-place-holder").html("<input type='hidden' id='billing-city-states' value='other'/>"); var a = $("#billingTxtCityStates").val().split(","); 1 < a.length ? ("" != a[0] && $("#BillingAddressControl_lblState").addClass("display-none"), "" != a[1] && $("#BillingAddressControl_lblCity").addClass("display-none"), $("#BillingAddressControl_txtState").val(a[0]), $("#BillingAddressControl_txtCity").val(a[1])) : ("" != a[0] && $("#BillingAddressControl_lblCity").addClass("display-none"), $("#BillingAddressControl_txtCity").val(a[0])) } "" != $("#shippingTxtCityStates").val() && ($(".shipping-zip-city-other-place-holder").fadeIn("Slow"), $("#shipping-enter-postal-label-place-holder").html("<input type='hidden' id='shipping-city-states' value='other'/>"), a = $("#shippingTxtCityStates").val().split(","), 1 < a.length ? ("" != a[0] && $("#ShippingAddressControl_lblState").addClass("display-none"), "" != a[1] && $("#ShippingAddressControl_lblCity").addClass("display-none"), $("#ShippingAddressControl_txtState").val($.trim(a[0])), $("#ShippingAddressControl_txtCity").val($.trim(a[1]))) : ("" != a[0] && $("#ShippingAddressControl_lblCity").addClass("display-none"), $("#ShippingAddressControl_txtCity").val(a[0]))); !1 == IsWithStates("BillingAddressControl_drpCountry") && ($("#BillingAddressControl_lblState").removeClass("display-none"), $("#BillingAddressControl_txtState").val(""), $("#BillingAddressControl_txtState").addClass("control-disabled"), $("#BillingAddressControl_txtState").fadeOut("slow", function () { $("#BillingAddressControl_lblState").addClass("display-none"); $("#BillingAddressControl_txtCity").addClass("city-width-if-no-state") })); !1 == IsWithStates("ShippingAddressControl_drpCountry") && ($("#ShippingAddressControl_lblState").removeClass("display-none"), $("#ShippingAddressControl_txtState").val(""), $("#ShippingAddressControl_txtState").addClass("control-disabled"), $("#ShippingAddressControl_txtState").fadeOut("slow", function () { $("#ShippingAddressControl_lblState").addClass("display-none"); $("#ShippingAddressControl_txtCity").addClass("city-width-if-no-state") })) } function InitProfileForm() { appConfigs.IS_CAPTCHA_REQUIRED && ($(constantID.INPUT_CAPTCHA).val(constants.EMPTY), $(constantID.INPUT_CAPTCHA).ISEBubbleMessage({ "input-id": "txtCaptcha", "label-id": "lblCaptcha" }), $(".captcha-section").fadeIn("slow")); $("#ProfileControl_txtFirstName").ISEBubbleMessage({ "input-id": "ProfileControl_txtFirstName", "label-id": "lblFirstName" }); $("#ProfileControl_txtLastName").ISEBubbleMessage({ "input-id": "ProfileControl_txtLastName", "label-id": "lblLastName" }); $("#ProfileControl_txtEmail").ISEBubbleMessage({ "input-id": "ProfileControl_txtEmail", "label-id": "lblEmail", "input-mode": "email" }); $("#ProfileControl_txtContactNumber").ISEBubbleMessage({ "input-id": "ProfileControl_txtContactNumber", "label-id": "lblContactNumber" }); $("#ProfileControl_txtPassword").ISEBubbleMessage({ "input-id": "ProfileControl_txtPassword", "label-id": "lblPassword", "input-mode": "password" }); $("#ProfileControl_txtConfirmPassword").ISEBubbleMessage({ "input-id": "ProfileControl_txtConfirmPassword", "label-id": "lblConfirmPassword", "input-mode": "password-confirmation" }); $("#old-password-input").ISEBubbleMessage({ "input-id": "old-password-input", "label-id": "old-password-input-label" }); $("#ProfileControl_txtMobile").ISEBubbleMessage({ "input-id": "ProfileControl_txtMobile", "label-id": "lblMobile", optional: !0 }) } function BindProfileFormEventsListener() { Profile_EditPassword(!1); $("#edit-password").removeAttr("checked"); $("#edit-password").click(function () { "checked" == $(this).attr("checked") ? Profile_EditPassword(!0) : Profile_EditPassword(!1) }); $("#captcha-refresh-button").click(function () { _CaptchaCounter += 1; _CaptchaCounter++; $("#captcha").attr("src", "Captcha.ashx?id=" + _CaptchaCounter) }); $("#support-security-code").css("width", "193px"); $("#captcha-label").css("padding-right", "31px"); $("#update-profile").click(function () { var a = $(this); if (a.hasClass("editable-content") || !ValidateProfileRequiredFields()) return !1; var b = GetObjectControl(profileConstantID.INPUT_EMAIL), c = b.parent("span").attr("data-accountType"), c = "undefined" == typeof c ? "" : $.trim(c); AjaxSecureEmailAddressVerification(!1, b.val(), c, function (a) { a = trimString(a.d); var c = ""; if ("" != a) { switch (a) { case "email-duplicates": c = a; break; case "invalid-email": c = a; break; default: c = "ajax-request-failed" } b.addClass(c).attr("response-message", a); b.focus(); if ("ajax-request-failed" == c) SubmitUpdateAccountButton(); else return !1 } else SubmitUpdateAccountButton() }, function (b) { a.addClass("request-error").attr("response-message", b) }) }) } function SubmitUpdateAccountButton() { if ("checked" == $("#edit-password").attr("checked")) { if (!ValidatePassword("ProfileControl_txtPassword")) return $("#ProfileControl_txtPassword").focus(), !1; if (!ValidatePassword("ProfileControl_txtConfirmPassword")) return $("#ProfileControl_txtConfirmPassword").focus(), !1; UpdateCustomerProfile(!0) } else UpdateCustomerProfile(!1) } function UpdateCustomerProfile(a) { var b = GetInputValue(profileConstantID.DRP_SALUTATION), c = constants.EMPTY, e = constants.EMPTY; a && (c = GetInputValue(profileConstantID.INPUT_PASSWORD), e = GetInputValue(profileConstantID.INPUT_OLD_PASSWORD)); ShowProcessMessage(ise.StringResource.getString("createaccount.aspx.121"), profileConstantID.DIV_ERROR_PLACEHOLDER, profileConstantID.DIV_SAVE_PROGRESS_PLACEHOLDER, profileConstantID.DIV_SAVE_BUTTON_PLACEHOLDER); a = {}; a.Salutation = b; a.FirstName = GetInputValue(profileConstantID.INPUT_FIRSTNAME); a.LastName = GetInputValue(profileConstantID.INPUT_LASTNAME); a.ContactNumber = GetInputValue(profileConstantID.INPUT_CONTACT_NUMBER); a.Email = GetInputValue(profileConstantID.INPUT_EMAIL); a.IsOkToEmail = IsElementChecked(profileConstantID.CHK_IS_OKTOEMAIL); a.IsOver13Checked = IsElementChecked(profileConstantID.CHK_IS_OVER13CHECKED); a.Mobile = GetInputValue(profileConstantID.INPUT_MOBILE); b = {}; b.account = JSON.stringify(a); b.newPassword = c; b.oldPassword = e; b.captcha = GetInputValue(profileConstantID.INPUT_CAPTCHA); $divErrorPlachHolder = GetObjectControl(profileConstantID.DIV_ERROR_PLACEHOLDER); AjaxCallWithSecuritySimplified(serviceMethods.UPDATE_ACCOUNTINFO, b, function (a) { message = a.d; message == constants.EMPTY ? (ShowProcessMessage(ise.StringResource.getString("createaccount.aspx.122"), profileConstantID.DIV_ERROR_PLACEHOLDER, profileConstantID.DIV_SAVE_PROGRESS_PLACEHOLDER, profileConstantID.DIV_SAVE_BUTTON_PLACEHOLDER), parent.location = "account.aspx") : ($divErrorPlachHolder.removeClass(constants.DISPLAY_NONE), ShowFailedMessage(message, profileConstantID.DIV_ERROR_PLACEHOLDER, profileConstantID.DIV_SAVE_PROGRESS_PLACEHOLDER, profileConstantID.DIV_SAVE_BUTTON_PLACEHOLDER)) }, function (a) { ShowFailedMessage(a.d, profileConstantID.DIV_ERROR_PLACEHOLDER, profileConstantID.DIV_SAVE_PROGRESS_PLACEHOLDER, profileConstantID.DIV_SAVE_BUTTON_PLACEHOLDER); $divErrorPlachHolder.removeClass(constants.DISPLAY_NONE) }) } function Profile_EditPassword(a) { $("#old-password-input").removeClass("required-input"); $("#old-password-input").removeClass("current-object-on-focus"); $("#ProfileControl_txtPassword").removeClass("required-input"); $("#ProfileControl_txtPassword").removeClass("current-object-on-focus"); $("#ProfileControl_txtConfirmPassword").removeClass("required-input"); $("#ProfileControl_txtConfirmPassword").removeClass("current-object-on-focus"); $("#ProfileControl_txtPassword").removeClass("password-not-match"); $("#ProfileControl_txtPassword").removeClass("password-not-strong"); $("#ProfileControl_txtConfirmPassword").removeClass("password-not-match"); $("#old-password-input-label").css("color", "#8E8E8E"); $("#lblPassword").css("color", "#8E8E8E"); $("#lblConfirmPassword").css("color", "#8E8E8E"); $("#ise-message-tips").fadeOut("slow"); a ? ($("#old-password-input").val(""), $("#ProfileControl_txtPassword").val(""), $("#ProfileControl_txtConfirmPassword").val(""), $("#old-password-input").removeClass("control-disabled"), $("#old-password-input-label").removeClass("display-none"), $("#old-password-input").removeAttr("disabled"), $("#ProfileControl_txtPassword").removeClass("control-disabled"), $("#ProfileControl_txtPassword").removeAttr("disabled"), $("#ProfileControl_lblPassword").removeClass("display-none"), $("#ProfileControl_txtConfirmPassword").removeClass("control-disabled"), $("#ProfileControl_lblConfirmPassword").removeClass("display-none"), $("#ProfileControl_txtConfirmPassword").removeAttr("disabled"), $("#password-caption").removeClass("control-caption-disabled"), $("#old-password-label-place-holder").removeClass("control-caption-disabled")) : ($("#old-password-label-place-holder").addClass("control-caption-disabled"), $("#old-password-input").addClass("control-disabled"), $("#old-password-input").attr("disabled", "disabled"), $("#ProfileControl_txtPassword").addClass("control-disabled"), $("#ProfileControl_txtPassword").attr("disabled", "disabled"), $("#ProfileControl_txtConfirmPassword").addClass("control-disabled"), $("#ProfileControl_txtConfirmPassword").attr("disabled", "disabled"), $("#password-caption").addClass("control-caption-disabled")) } function BindBubbleMessagePluginToAddressControl() { $("#AddressControl_txtPostal").ISEAddressFinder({ "country-id": "#AddressControl_drpCountry", "postal-id": "#AddressControl_txtPostal", "city-id": "#AddressControl_txtCity", "state-id": "#AddressControl_txtState", "city-state-place-holder": ".zip-city-other-place-holder", "enter-postal-label-place-holder": "#enter-postal-label-place-holder", "city-states-id": "city-states" }); $("#txtContactName").ISEBubbleMessage({ "input-id": "txtContactName", "label-id": "lblContactName" }); $("#txtContactNumber").ISEBubbleMessage({ "input-id": "txtContactNumber", "label-id": "lblContactNumber" }); $("#AddressControl_txtStreet").ISEBubbleMessage({ "input-id": "AddressControl_txtStreet", "label-id": "AddressControl_lblStreet" }); $("#AddressControl_txtPostal").ISEBubbleMessage({ "input-id": "AddressControl_txtPostal", "label-id": "AddressControl_lblPostal", "input-mode": "postal" }); $("#AddressControl_txtCity").ISEBubbleMessage({ "input-id": "AddressControl_txtCity", "label-id": "AddressControl_lblCity" }); $("#AddressControl_txtState").ISEBubbleMessage({ "input-id": "AddressControl_txtState", "label-id": "AddressControl_lblState", "input-mode": "state" }); "undefined" != typeof $("#AddressControl_txtCounty").val() && $("#AddressControl_txtCounty").ISEBubbleMessage({ "input-id": "AddressControl_txtCounty", "label-id": "AddressControl_lblCounty", optional: !0 }); $("#txtContactName").addClass("edit-address-contact-name") } function BindAddressControlEventsListener(a) { a || ($(".zip-city-other-place-holder").fadeIn("Slow"), $("#enter-postal-label-place-holder").html("<input type='hidden' id='city-states' value='other'/>")); $("#save-address").click(function () { if ($(this).hasClass("editable-content")) return !0; SaveAddress(a) }) } function SaveAddress(a) { $("#ise-message-tips").fadeOut("slow"); var b = 0, c = !1, e = !1; $(".requires-validation").each(function () { var a = trimString($(this).val()); if ("" == a) { e = !1; var d = "#" + $(this).attr("id"), f = $(".zip-city-other-place-holder").css("display"); "#AddressControl_txtCity" == d && ("none" == f ? e = !0 : (e = !0, "" == a && (e = !1))); "#AddressControl_txtState" == d && (d = IsWithStates("AddressControl_drpCountry"), "none" == f || !1 == d ? e = !0 : (e = !0, "" == a && (e = !1))); a = $(this).attr("id"); IsPostalInputBoxOptional(a) && (e = !0); !1 == e && ($(this).removeClass("current-object-on-focus"), $(this).addClass("required-input"), 0 == b && ($(this).attr("id"), $(this).addClass("current-object-on-focus"), $(this).focus()), c = !0, b++) } }); if (c) return $("").focus(), !1; var d = $("#city-states").val(), f = $("#AddressControl_txtPostal"); if (typeof d == constants.TYPE_UNDEFINED || d == constants.EMPTY) return f.addClass("invalid-postal-zero").focus(), !1; f.removeClass("invalid-postal-zero").focus(); VerifyAddress_v2(a) } function ValidateProfileRequiredFields() { var a = 0, b = !0, c = !1; $(".requires-validation").each(function () { var e = $(this); c = !1; "disabled" == e.attr("disabled") && (c = !0); "" == e.val() && !1 == c && (e.removeClass("current-object-on-focus").addClass("required-input"), 0 == a && e.addClass("current-object-on-focus").focus(), a++, b = !1) }); return b } function LoadCustmerRequiredAppConfiguration(a, b) { var c = []; if (a == constants.TYPE_SIGNUP || a == constants.TYPE_PROFILE) c.push("UseStrongPwd"), c.push("RequireOver13Checked"), c.push("AllowShipToDifferentThanBillTo"), c.push("AllowCustomerDuplicateEMailAddresses"), c.push("VAT.ShowTaxFieldOnRegistration"), c.push("VAT.Enabled"), c.push("CustomerPwdValidator"), c.push("SecurityCodeRequiredOnCreateAccount"), c.push("PasswordMinLength"); c.push("UseShippingAddressVerification"); ise.Configuration.loadResources(c, b) } function LoadCustomerRequiredStringResources(a) { var b = []; switch (a) { case constants.TYPE_SIGNUP: b.push("createaccount.aspx.28"); b.push("createaccount.aspx.52"); b.push("createaccount.aspx.79"); b.push("createaccount.aspx.80"); b.push("createaccount.aspx.81"); b.push("createaccount.aspx.82"); b.push("createaccount.aspx.94"); b.push("createaccount.aspx.120"); b.push("createaccount.aspx.123"); b.push("createaccount.aspx.125"); b.push("selectaddress.aspx.6"); b.push("selectaddress.aspx.12"); b.push("selectaddress.aspx.13"); b.push("createaccount.aspx.158"); b.push("createaccount.aspx.159"); break; case constants.TYPE_PROFILE: b.push("createaccount.aspx.81"); b.push("createaccount.aspx.94"); b.push("createaccount.aspx.28"); b.push("createaccount.aspx.52"); b.push("createaccount.aspx.120"); b.push("createaccount.aspx.121"); b.push("createaccount.aspx.122"); b.push("selectaddress.aspx.6"); b.push("selectaddress.aspx.12"); b.push("selectaddress.aspx.13"); break; case constants.TYPE_ADDRESS: b.push("selectaddress.aspx.8"), b.push("selectaddress.aspx.9"), b.push("createaccount.aspx.159") } b.push("customersupport.aspx.15"); b.push("customersupport.aspx.16"); b.push("customersupport.aspx.17"); b.push("customersupport.aspx.18"); b.push("customersupport.aspx.23"); b.push("customersupport.aspx.24"); b.push("customersupport.aspx.38"); b.push("customersupport.aspx.39"); b.push("customersupport.aspx.40"); b.push("customersupport.aspx.41"); b.push("selectaddress.aspx.7"); b.push("selectaddress.aspx.10"); b.push("selectaddress.aspx.11"); ise.StringResource.loadResources(b, function () { }) } function GetObjectControl(a) { return $(constants.SEP_POUND + a) } function HideElement(a) { $(constants.SEP_POUND + a).addClass(constants.DISPLAY_NONE) } function ShowElement(a) { $(constants.SEP_POUND + a).removeClass(constants.DISPLAY_NONE) } function ConvertStringToLower(a) { return "undefined" == typeof a ? "" : a.toLowerCase() } function VerifyAddress_v2(a) { var b = GetObjectControl(addressConstantID.INPUT_POSTAL), c = GetInputValue(addressConstantID.DRP_COUNTRY), e = GetInputValue(addressConstantID.INPUT_POSTAL), d = GetInputValue(addressConstantID.INPUT_STATE), f = !0, g = !0 == b.hasClass("is-postal-optional") && "" == e; IsSearchable(addressConstantID.DRP_COUNTRY) && !1 == g && IsPostalFormatInvalid(c, e) && (b.addClass(constantErrorTags.INVALID_POSTAL), "none" == ConvertStringToLower($(".zip-city-other-place-holder").css("display")) && $(constantID.DIV_ENTER_POSTAL).html(ise.StringResource.getString("customersupport.aspx.40")), f = !1); if (!1 == f) return hideProgressIndicator(constantID.DIV_UPDATE_ADDRESS_LOADER, constantID.DIV_UPDATE_ADDRESS_BUTTON_CONTAINER), !1; b = {}; b.country = c; b.postal = e; b.stateCode = d; validatePostalCode(b, a ? submitAddNewAddresForm : submitEditAddresForm) } function VerifySignUpFormAddress_v2() { var a = GetObjectControl(addressConstantID.INPUT_BILLING_POSTAL), b = GetInputValue(addressConstantID.DRP_BILLING_COUNTRY), c = GetInputValue(addressConstantID.INPUT_BILLING_POSTAL), e = GetInputValue(addressConstantID.INPUT_BILLING_STATE), d = !0, f = !0 == a.hasClass("is-postal-optional") && "" == c; IsSearchable(addressConstantID.DRP_BILLING_COUNTRY) && !1 == f && IsPostalFormatInvalid(b, c) && (a.addClass(constantErrorTags.INVALID_POSTAL), "none" == ConvertStringToLower($(".billing-zip-city-other-place-holder").css("display")) && $(constantID.DIV_BILLING_ENTER_POSTAL).html(ise.StringResource.getString("customersupport.aspx.40")), d = !1); var g = a = constants.EMPTY, h = constants.EMPTY; if (appConfigs.IS_SHOW_SHIPPING && !1 == IsElementChecked("copyBillingInfo")) { var k = GetObjectControl(addressConstantID.INPUT_SHIPPING_POSTAL), a = GetInputValue(addressConstantID.DRP_SHIPPING_COUNTRY), g = GetInputValue(addressConstantID.INPUT_SHIPPING_POSTAL), h = GetInputValue(addressConstantID.INPUT_SHIPPING_STATE), f = !0 == k.hasClass("is-postal-optional") && "" == g; IsSearchable(addressConstantID.DRP_SHIPPING_COUNTRY) && !1 == f && IsPostalFormatInvalid(a, g) && (k.addClass(constantErrorTags.INVALID_POSTAL), "none" == ConvertStringToLower($(".shipping-zip-city-other-place-holder").css("display")) && $(constantID.DIV_SHIPPING_ENTER_POSTAL).html(ise.StringResource.getString("customersupport.aspx.40")), d = !1) } if (!1 == d) return hideProgressIndicator(constantID.DIV_SAVE_ACCOUNT_LOADER, constantID.DIV_SAVE_ACCOUNT_BUTTON_CONTAINER), !1; appConfigs.IS_SHOW_SHIPPING && IsElementChecked("copyBillingInfo") && (g = c, a = b, h = e); d = {}; d.country = b; d.postal = c; d.stateCode = e; d.shipToCountry = a; d.shipToPostal = g; d.shipToStateCode = h; validateSignUpPostalCodes(d, submitSignUpForm) } function validateSignUpPostalCodes(a, b) { var c = { country: a.country, postal: a.postal, stateCode: a.stateCode, shipToCountry: a.shipToCountry, shipToPostal: a.shipToPostal, shipToStateCode: a.shipToStateCode }, e = $.trim(ise.StringResource.getString("createaccount.aspx.159")); typeof e != constants.TYPE_UNDEFINED && e != constants.EMPTY && ShowProcessMessage(e, "error-summary", constantID.DIV_SAVE_ACCOUNT_LOADER, constantID.DIV_SAVE_ACCOUNT_BUTTON_CONTAINER); AjaxCallCommon("ActionService.asmx/ValidatePostalCode", c, function (a) { a = parseInt(a.d); $billingPostalInputBox = GetObjectControl(addressConstantID.INPUT_BILLING_POSTAL); $billingStateInputBox = GetObjectControl(addressConstantID.INPUT_BILLING_STATE); $shippingPostalInputBox = GetObjectControl(addressConstantID.INPUT_SHIPPING_POSTAL); $shippingStateInputBox = GetObjectControl(addressConstantID.INPUT_SHIPPING_STATE); $billingPostalInputBox.removeClass(constantErrorTags.POSTAL_NOT_FOUND); $billingStateInputBox.removeClass(constantErrorTags.STATE_NOT_FOUND); $shippingPostalInputBox.removeClass(constantErrorTags.POSTAL_NOT_FOUND); $shippingStateInputBox.removeClass(constantErrorTags.STATE_NOT_FOUND); if (0 == a) return b(c), !1; hideProgressIndicator(constantID.DIV_SAVE_ACCOUNT_LOADER, constantID.DIV_SAVE_ACCOUNT_BUTTON_CONTAINER); if (1 == a) return $billingPostalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), $billingStateInputBox.addClass(constantErrorTags.STATE_NOT_FOUND), $billingPostalInputBox.focus(), !1; if (2 == a) return $shippingPostalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), $shippingStateInputBox.addClass(constantErrorTags.STATE_NOT_FOUND), $shippingPostalInputBox.focus(), !1; if (3 == a) return $billingPostalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), $billingStateInputBox.addClass(constantErrorTags.STATE_NOT_FOUND), $shippingPostalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), $shippingStateInputBox.addClass(constantErrorTags.STATE_NOT_FOUND), $billingPostalInputBox.focus(), !1 }, function (a) { b(c) }) } function validatePostalCode(a, b) { var c = { country: a.country, postal: a.postal, stateCode: a.stateCode, shipToCountry: constants.EMPTY, shipToPostal: constants.EMPTY, shipToStateCode: constants.EMPTY }, e = $.trim(ise.StringResource.getString("createaccount.aspx.159")); typeof e != constants.TYPE_UNDEFINED && e != constants.EMPTY && ShowProcessMessage(e, "error-summary", constantID.DIV_UPDATE_ADDRESS_LOADER, constantID.DIV_UPDATE_ADDRESS_BUTTON_CONTAINER); AjaxCallCommon("ActionService.asmx/ValidatePostalCode", c, function (a) { $postalInputBox = GetObjectControl(addressConstantID.INPUT_POSTAL); GetObjectControl(addressConstantID.INPUT_STATE).removeClass(constantErrorTags.STATE_NOT_FOUND); $postalInputBox.removeClass(constantErrorTags.POSTAL_NOT_FOUND); a = parseInt(a.d); if (0 == a) return b(c), !1; 1 == a && (GetObjectControl(addressConstantID.INPUT_STATE).addClass(constantErrorTags.STATE_NOT_FOUND), $postalInputBox.addClass(constantErrorTags.POSTAL_NOT_FOUND), $postalInputBox.focus()); hideProgressIndicator(constantID.DIV_UPDATE_ADDRESS_LOADER, constantID.DIV_UPDATE_ADDRESS_BUTTON_CONTAINER) }, function (a) { b(c) }) } function submitSignUpForm(a) { var b = function () { var a = $(constantID.BTN_HIDDEN_SIGNUP), b = $("#billingTxtCityStates"), d = GetInputValue(addressConstantID.HIDDEN_BILLING_CITYSTATE); b.val(d); d == constants.TYPE_OTHER && b.val(GetInputValue(addressConstantID.INPUT_BILLING_STATE) + ", " + GetInputValue(addressConstantID.INPUT_BILLING_CITY)); appConfigs.IS_SHOW_SHIPPING && (b = $("#shippingTxtCityStates"), d = GetInputValue(addressConstantID.HIDDEN_SHIPPING_CITYSTATE), b.val(d), d == constants.TYPE_OTHER && b.val(GetInputValue(addressConstantID.INPUT_SHIPPING_STATE) + "," + GetInputValue(addressConstantID.INPUT_SHIPPING_CITY))); ShowProcessMessage(ise.StringResource.getString("createaccount.aspx.125"), "error-summary", constantID.DIV_SAVE_ACCOUNT_LOADER, constantID.DIV_SAVE_ACCOUNT_BUTTON_CONTAINER); a.trigger("click") }; if (!1 == appConfigs.IS_GET_ADDRESS_MATCH || "" == a.postal || "" == a.shipToPostal && appConfigs.IS_SHOW_SHIPPING) return b(), !1; typeof $.fn.RealTimeAddressVerification != constants.TYPE_UNDEFINED ? $.fn.RealTimeAddressVerification.requestAddressMatch(b) : b() } function submitAddNewAddresForm(a) { var b = function () { var a = $("#txtCityStates"), b = GetInputValue(addressConstantID.HIDDEN_CITYSTATE); a.val(b); b == constants.TYPE_OTHER && (b = GetInputValue(addressConstantID.INPUT_STATE) + ", " + GetInputValue(addressConstantID.INPUT_CITY), $("#txtCityStates").val(b)); ShowProcessMessage(ise.StringResource.getString("selectaddress.aspx.9"), "error-summary", constantID.DIV_UPDATE_ADDRESS_LOADER, constantID.DIV_UPDATE_ADDRESS_BUTTON_CONTAINER); $(constantID.BTN_ADD_ADDRESS).trigger("click") }; if (!1 == appConfigs.IS_GET_ADDRESS_MATCH || "" == a.postal) return b(), !1; typeof $.fn.RealTimeAddressVerification != constants.TYPE_UNDEFINED ? $.fn.RealTimeAddressVerification.requestAddressMatch(b) : b() } function submitEditAddresForm(a) { var b = function () { var a = $("#txtCityStates"), b = GetInputValue(addressConstantID.HIDDEN_CITYSTATE); a.val(b); b == constants.TYPE_OTHER && (b = GetInputValue(addressConstantID.INPUT_STATE) + ", " + GetInputValue(addressConstantID.INPUT_CITY), $("#txtCityStates").val(b)); ShowProcessMessage(ise.StringResource.getString("selectaddress.aspx.8"), "error-summary", constantID.DIV_UPDATE_ADDRESS_LOADER, constantID.DIV_UPDATE_ADDRESS_BUTTON_CONTAINER); $(constantID.BTN_UPDATE_ADDRESS).trigger("click") }; if (!1 == appConfigs.IS_GET_ADDRESS_MATCH || "" == a.postal) return b(), !1; typeof $.fn.RealTimeAddressVerification != constants.TYPE_UNDEFINED ? $.fn.RealTimeAddressVerification.requestAddressMatch(b) : b() } function hideProgressIndicator(a, b) { $("#" + a).fadeOut("slow", function () { $("#" + b).fadeIn("slow") }) };