(function (b) { var d = { init: function (a) { a = b.extend({ "input-id": "", "label-id": "", "input-mode": "normal", "address-type": "", optional: !1 }, a); b(this).ISEBubbleMessage("initEventsListener", a) }, initEventsListener: function (a) { $this = b("#" + a["input-id"]); b("#" + a["label-id"]).unbind("click").click(function () { b(this).addClass("display-none"); b("#" + a["input-id"]).ISEBubbleMessage("cleanInputControl", { "control-id": a["input-id"], "input-mode": a["input-mode"], "label-id": a["label-id"] }); b("#" + a["input-id"]).val("").addClass("ie-placeholder-fix").trigger("focus") }); var c = $this.val(), c = "undefined" == typeof c ? "" : b.trim(c); "" != c ? b("#" + a["label-id"]).addClass("display-none") : $this.val(c); a.optional || $this.addClass("requires-validation"); $this.focus(function () { var c = b(this), e = c.attr("id"), f = GetInputValue(e), f = "undefined" == typeof f ? "" : b.trim(f), d = IsInArray(["BillingAddressControl_txtPostal", "ShippingAddressControl_txtPostal", "AddressControl_txtPostal"], e); if (c.hasClass("editable-content") || d && !0 == c.hasClass("is-postal-optional") && "" == f) return !1; a.optional || !1 != c.hasClass("ie-placeholder-fix") || (c.ISEBubbleMessage("checkPreviousControlOnFocus", a), c.ISEBubbleMessage("lookForAnErrorTag", { "input-id": e, "address-type": a["address-type"] })); c.removeClass("ie-placeholder-fix") }); $this.blur(function () { var c = b(this); if (c.hasClass("editable-content")) return !1; var e = c.val(), e = "undefined" == typeof e ? "" : b.trim(e); "" == e && (b("#" + a["label-id"]).removeClass("display-none"), b("#" + a["label-id"]).css("color", labelFadeInColor)); c.val(e) }); $this.keypress(function (c) { var e = b(this); if (e.hasClass("editable-content")) return !1; 0 < (c.keyCode ? c.keyCode : c.which) && e.ISEBubbleMessage("cleanInputControl", { "control-id": a["input-id"], "input-mode": a["input-mode"], "label-id": a["label-id"] }) }); $this.keydown(function (c) { c = c.keyCode ? c.keyCode : c.which; var e = b(this), f = e.val(), f = "undefined" == typeof f ? "" : b.trim(f); if ("" == f || 8 === c) { if (e.hasClass("editable-content")) return !1; e.ISEBubbleMessage("cleanInputControl", { "control-id": a["input-id"], "input-mode": a["input-mode"], "label-id": a["label-id"] }) } }); $this.mousedown(function (c) { c = c.keyCode ? c.keyCode : c.which; var e = b(this), f = e.val(), f = "undefined" == typeof f ? "" : b.trim(f); if ("" == f || 8 === c) { if (e.hasClass("editable-content")) return !1; e.ISEBubbleMessage("cleanInputControl", { "control-id": a["input-id"], "input-mode": a["input-mode"], "label-id": a["label-id"] }) } }) }, checkPreviousControlOnFocus: function (a) { $this = b("#" + a["input-id"]); var c = b(".current-object-on-focus").attr("id"), k = _prevObjectType; _prevObjectType = a["input-mode"]; b(".requires-validation").each(function () { b(this).removeClass("current-object-on-focus") }); "undefined" != typeof c && ("" == b("#" + c).val() && b("#" + c).addClass("required-input"), $this.ISEBubbleMessage("validate", [c, k])); b("#" + a["label-id"]).animate({ color: labelFadeOutColor }, 500); b("#" + a["input-id"]).addClass("current-object-on-focus") }, cleanInputControl: function (a) { b("#" + a["label-id"]).addClass("display-none"); var c = b("#" + a["control-id"]); switch (a["input-mode"]) { case "email": c.removeClass("invalid-email"); c.removeClass("email-duplicates"); break; case "billing-postal": c.removeClass("invalid-postal"); c.removeClass("invalid-postal-zero"); c.removeClass("invalid-postal-many"); break; case "shipping-postal": c.removeClass("invalid-postal"); c.removeClass("invalid-postal-zero"); c.removeClass("invalid-postal-many"); break; case "password": c.removeClass("password-not-match"); c.removeClass("password-not-strong"); c.removeClass("password-length-invalid"); break; case "password-confirmation": c.removeClass("password-not-match"), c.removeClass("password-not-strong") } c.removeClass("required-input"); b("#ise-message-tips").fadeOut("slow") }, lookForAnErrorTag: function (a) { a = b.extend({ "input-id": "", "address-type": "" }, a); var c = b("#" + a["input-id"]), k = c.attr("class").split(" "), e = b(this).offset().left, f = 17, d = b(this).offset().top, l = 47, g = "", h = !1; switch (k[k.length - 2]) { case "required-input": g = ise.StringResource.getString("customersupport.aspx.15"); h = !0; break; case "invalid-email": g = ise.StringResource.getString("customersupport.aspx.16"); h = !0; break; case "email-duplicates": g = ise.StringResource.getString("createaccount.aspx.94"); h = !0; break; case "invalid-postal": f = 17; l = 65; g = ise.StringResource.getString("customersupport.aspx.38") + "<div class='clear-both height-5'></div> Please click <a id='show-postal-listing-dialog-many' onClick='FindPostal(\"" + a["address-type"] + "\")' href='javascript:void(1);'>HERE</a> to select your postal code"; h = !0; break; case "state-not-found": k = a["address-type"]; switch (a["input-id"]) { case "ShippingAddressControl_txtState": k = "Shipping"; break; case "BillingAddressControl_txtState": k = "Billing" } f = 17; l = 65; g = ise.StringResource.getString("customersupport.aspx.39") + "<div class='clear-both height-5'></div> Please click <a id='show-postal-listing-dialog-many' onClick='FindPostal(\"" + k + "\")' href='javascript:void(1);'>HERE</a> to select your postal code"; h = !0; break; case "invalid-postal-zero": f = 17; l = 72; g = ise.StringResource.getString("customersupport.aspx.17") + "<div class='clear-both height-12'></div> Please click <a id='show-postal-listing-dialog-many' onClick='FindPostal(\"" + a["address-type"] + "\")' href='javascript:void(1);'>HERE</a> to correct your postal code"; "true" == ise.Configuration.getConfigValue("AllowCustomPostal.Enabled") && (l = 92, g += " <div class='clear-both height-5'></div> or click <a href='javascript:void(1);' onClick='SkipValidationOnPostal(\"" + a["address-type"] + "\", true)'>HERE</a> to continue on using your entered postal code."); h = !0; break; case "invalid-captcha": g = ise.StringResource.getString("customersupport.aspx.18"); h = !0; break; case "password-not-match": g = ise.StringResource.getString("createaccount.aspx.52"); h = !0; break; case "password-not-strong": g = ise.StringResource.getString("createaccount.aspx.28"); 200 < g.length && (l = 88); h = !0; break; case "password-length-invalid": g = "Password length is not valid"; h = !0; break; case "lead-duplicates": g = ise.StringResource.getString("leadform.aspx.20"), h = !0 } h && c.ISEBubbleMessage("showTips", { "top-position": d, "top-deduction": l, "left-position": e, "left-deduction": f, message: g }) }, showTips: function (a) { a = b.extend({ "top-position": 0, "top-deduction": 0, "left-position": 0, "left-deduction": 0, message: "" }, a); b("#ise-message-tips").css("top", a["top-position"] - a["top-deduction"]); b("#ise-message-tips").css("left", a["left-position"] - a["left-deduction"]); b("#ise-message").html(a.message); b("#ise-message-tips").fadeIn("slow") }, validate: function (a) { var c = b("#" + a[0]), d = c.hasClass("skip"); switch (a[1]) { case "email": a = c.parent("span").attr("data-accountType"); a = "undefined" == typeof a ? "" : b.trim(a); AjaxSecureEmailAddressVerification(!1, c.val(), a, function (a) { a = trimString(a.d); var b = ""; if ("" != a) { switch (a) { case "email-duplicates": b = a; break; case "invalid-email": b = a; break; default: b = "request-error" } c.addClass(b).attr("response-message", a) } }, function (a) { c.addClass("request-error").attr("response-message", a) }); break; case "postal": a = b("#AddressControl_drpCountry").val(); d = b("#AddressControl_txtPostal").val(); b("#AddressControl_txtState").val(); a = c.ISEAddressFinder("isPostalFormatInvalid", { country: a, postal: d }); break; case "shipping-postal": a = b("#ShippingAddressControl_drpCountry").val(); d = b("#ShippingAddressControl_txtPostal").val(); b("#ShippingAddressControl_txtState").val(); a = c.ISEAddressFinder("isPostalFormatInvalid", { country: a, postal: d }); break; case "billing-postal": a = b("#BillingAddressControl_drpCountry").val(); d = b("#BillingAddressControl_txtPostal").val(); b("#BillingAddressControl_txtState").val(); a = c.ISEAddressFinder("isPostalFormatInvalid", { country: a, postal: d }); break; case "state": d || (a = b("#AddressControl_drpCountry").val(), d = b("#AddressControl_txtPostal").val(), b("#AddressControl_txtState").val(), (a = c.ISEAddressFinder("isPostalFormatInvalid", { country: a, postal: d })) || c.ISEAddressFinder("verifyStateCode", { "country-id": "#AddressControl_drpCountry", "postal-id": "#AddressControl_txtPostal", "city-id": "#AddressControl_txtCity", "state-id": "#AddressControl_txtState", "city-state-place-holder": ".zip-city-other-place-holder", "enter-postal-label-place-holder": "#enter-postal-label-place-holder", "city-states-id": "city-states" })); break; case "shipping-state": d || (a = b("#ShippingAddressControl_drpCountry").val(), d = b("#ShippingAddressControl_txtPostal").val(), b("#ShippingAddressControl_txtState").val(), (a = c.ISEAddressFinder("isPostalFormatInvalid", { country: a, postal: d })) || c.ISEAddressFinder("verifyStateCode", { "country-id": "#ShippingAddressControl_drpCountry", "postal-id": "#ShippingAddressControl_txtPostal", "city-id": "#ShippingAddressControl_txtCity", "state-id": "#ShippingAddressControl_txtState", "city-state-place-holder": ".shipping-zip-city-other-place-holder", "enter-postal-label-place-holder": "#shipping-enter-postal-label-place-holder", "city-states-id": "shipping-city-states" })); break; case "billing-state": d || (a = b("#BillingAddressControl_drpCountry").val(), d = b("#BillingAddressControl_txtPostal").val(), b("#BillingAddressControl_txtState").val(), (a = c.ISEAddressFinder("isPostalFormatInvalid", { country: a, postal: d })) || c.ISEAddressFinder("verifyStateCode", { "country-id": "#BillingAddressControl_drpCountry", "postal-id": "#BillingAddressControl_txtPostal", "city-id": "#BillingAddressControl_txtCity", "state-id": "#BillingAddressControl_txtState", "city-state-place-holder": ".billing-zip-city-other-place-holder", "enter-postal-label-place-holder": "#billing-enter-postal-label-place-holder", "city-states-id": "billing-city-states" })); break; case "password": ValidatePassword("ProfileControl_txtPassword"); break; case "password-confirmation": b("#ProfileControl_txtPassword").val() != b("#ProfileControl_txtConfirmPassword").val() ? (b("#ProfileControl_txtPassword").addClass("password-not-match"), b("#ProfileControl_txtConfirmPassword").addClass("password-not-match")) : (b("#ProfileControl_txtPassword").removeClass("password-not-match"), b("#ProfileControl_txtConfirmPassword").removeClass("password-not-match")) } } }; b.fn.ISEBubbleMessage = function (a) { if (d[a]) return d[a].apply(this, Array.prototype.slice.call(arguments, 1)); if ("object" !== typeof a && a) b.error("Method " + a + " does not exist on jQuery.tooltip"); else return d.init.apply(this, arguments) } })(jQuery); function VerifyCaptcha(b) { b = JSON.stringify({ list: [b[0]], task: "validate-captcha" }); $.ajax({ type: "POST", url: "ActionService.asmx/CreateLeadTaskController", data: b, contentType: "application/json; charset=utf-8", dataType: "json", success: function (b) { "match" == b.d ? $("#support-security-code").removeClass("support-invalid-captcha") : $("#support-security-code").addClass("support-invalid-captcha") }, fail: function (b) { } }) } function ShowProcessMessage(b, d, a, c) { b = "<div style='float:left;width:12px;'><i class='icon icon-spin icon-spinner progress-indicator'></i></div> <div id='loader-container'>" + b + "</div>"; $("#" + c).css("display", "none"); $("#" + a).html("<div style='float:right' class='OPCLoadStep'>" + b + "</div>"); $("#" + a).fadeIn("slow"); $("#" + d).html(""); $("#" + d).fadeOut("slow") } function ShowFailedMessage(b, d, a, c) { "" == b ? $("#" + d).removeClass("error-place-holder") : $("#" + d).addClass("error-place-holder"); $("#" + d).html(b); $("#" + d).fadeIn("slow", function () { $("#" + a).fadeOut("fast", function () { $("#" + c).fadeIn("fast") }) }) } function PopulateResources(b, d) { for (var a = $.parseJSON(d), c = 0; c < a.length; c++) b ? ise.Configuration.registerConfig(a[c].Key, a[c].Value) : ise.StringResource.registerString(a[c].Key, a[c].Value) } function ShowBubbleTips(b, d) { var a = $(b).offset().left, c = $(b).offset().top; $("#ise-message-tips").css("top", c - 47); $("#ise-message-tips").css("left", a - 17); $("#ise-message").html(d); $("#ise-message-tips").fadeIn("slow") } function GetStringResources(b, d) { var a = []; switch (b) { case "lead-form": a.push("leadform.aspx.24"); a.push("createaccount.aspx.94"); a.push("leadform.aspx.20"); a.push("createaccount.aspx.81"); a.push("customersupport.aspx.40"); a.push("createaccount.aspx.158"); a.push("createaccount.aspx.159"); break; case "customer-support": a.push("customersupport.aspx.25"); a.push("createaccount.aspx.81"); break; case "create-account": a.push("createaccount.aspx.28"); a.push("createaccount.aspx.52"); a.push("createaccount.aspx.79"); a.push("createaccount.aspx.80"); a.push("createaccount.aspx.81"); a.push("createaccount.aspx.82"); a.push("createaccount.aspx.94"); a.push("createaccount.aspx.120"); a.push("createaccount.aspx.123"); a.push("createaccount.aspx.125"); a.push("selectaddress.aspx.6"); a.push("selectaddress.aspx.12"); a.push("selectaddress.aspx.13"); break; case "edit-profile": a.push("createaccount.aspx.81"); a.push("createaccount.aspx.94"); a.push("createaccount.aspx.52"); a.push("createaccount.aspx.120"); a.push("createaccount.aspx.121"); a.push("createaccount.aspx.122"); a.push("selectaddress.aspx.6"); a.push("selectaddress.aspx.12"); a.push("selectaddress.aspx.13"); break; case "address": a.push("selectaddress.aspx.8"); a.push("selectaddress.aspx.9"); break; case "one-page-checkout": a.push("createaccount.aspx.94"); a.push("createaccount.aspx.123"); a.push("checkout1.aspx.9"); a.push("checkout1.aspx.45"); a.push("checkout1.aspx.46"); a.push("checkout1.aspx.47"); a.push("checkout1.aspx.48"); a.push("selectaddress.aspx.6"); a.push("checkoutpayment.aspx.5"); a.push("checkoutshipping.aspx.9"); a.push("checkoutshipping.aspx.10"); a.push("checkoutshipping.aspx.11"); a.push("checkoutshipping.aspx.12"); break; case "case-history": a.push("customersupport.aspx.44"), a.push("customersupport.aspx.45"), a.push("customersupport.aspx.46"), a.push("customersupport.aspx.47"), a.push("customersupport.aspx.48") } d && (a.push("customersupport.aspx.15"), a.push("customersupport.aspx.16"), a.push("customersupport.aspx.17"), a.push("customersupport.aspx.18"), a.push("customersupport.aspx.23"), a.push("customersupport.aspx.24"), a.push("customersupport.aspx.38"), a.push("customersupport.aspx.39"), a.push("customersupport.aspx.40"), a.push("customersupport.aspx.41"), a.push("selectaddress.aspx.7"), a.push("selectaddress.aspx.10"), a.push("selectaddress.aspx.11")); a = a = JSON.stringify({ keys: a }); $.ajax({ type: "POST", url: "ActionService.asmx/GetStringResources", dataType: "json", data: a, contentType: "application/json; charset=utf-8", success: function (a) { PopulateResources(!1, a.d) }, error: function (a) { console.log(a.d) } }) } function IsEmailGood(b) { return /(^[a-zA-Z0-9._-]+@[a-zA-Z0-9]+([.-]?[a-zA-Z0-9]+)?([\.]{1}[a-zA-Z]{2,4}){1,50}$)/.test(b) } function GetInputValue(b) { return $.trim($("#" + b).val()) }