var _imRegistered = !1, _finalButtonText = ""; $(document).ready(function () { InitPlugIn(); InitOnePageCheckout() }); $(window).load(function () { $("#ctrlPaymentTerm_chkSaveCreditCardInfo").click(function () { var a = $(this).attr("checked"); $("#ctrlPaymentTerm_chkSaveCreditCardInfo") && (a && void 0 != a ? $("#ctrlPaymentTerm_chkSaveCreditCardInfo").attr("checked", "checked") : $("#ctrlPaymentTerm_chkSaveCreditCardInfo").removeAttr("checked")) }); initializeLoaderListener() }); function initializeLoaderListener() { var a = 0, a = setInterval(function () { var b = ise.Controls.ShippingMethodController.getControl("ctrlShippingMethod"); null != b && "undefined" != b ? "true" == b.isShippingOnDemand ? b.isAutoClickOfOption || ($("body").data("globalLoader").hide(), clearInterval(a)) : b.shippingMethodLoadingComplete && ($("body").data("globalLoader").hide(), clearInterval(a)) : ($("body").data("globalLoader").hide(), clearInterval(a)) }, 200) } function InitOnePageCheckout() { $("body").data("globalLoader").show(); LoadOnePageCheckoutStringResources(); LoadOnePageCheckoutRequiredAppConfiguration(function () { HideShipToSection() }); GetCustomerInfo(!1, "shipping-contact", ""); GetCustomerInfo(!1, "payments-info", ""); EventsListener(); CreditCardPanelStylesWorkAround() } function HideShipToSection() { "false" == ise.Configuration.getConfigValue("AllowShipToDifferentThanBillTo") && ($("#edit-shipping-method").addClass("display-none"), $("#shipping-details-wrapper-hidden").addClass("display-none"), $("#shipping-helpful-tips-place-holder").addClass("display-none"), $("#copyShippingInfo").attr("disabled", !0), $("#shipping-methods-wrapper").css("border-top", "none")) } function LoadOnePageCheckoutRequiredAppConfiguration(a) { var b = []; b.push("VAT.ShowTaxFieldOnRegistration"); b.push("RequireOver13Checked"); b.push("AllowShipToDifferentThanBillTo"); b.push("AllowCustomerDuplicateEMailAddresses"); b.push("VAT.Enabled"); b.push("UseShippingAddressVerification"); b.push("RequireTermsAndConditionsAtCheckout"); b.push("SagePay.PaymentTerm"); ise.Configuration.loadResources(b, a) } function LoadOnePageCheckoutStringResources() { var a = []; a.push("createaccount.aspx.94"); a.push("createaccount.aspx.123"); a.push("checkout1.aspx.9"); a.push("checkout1.aspx.45"); a.push("checkout1.aspx.46"); a.push("checkout1.aspx.47"); a.push("checkout1.aspx.48"); a.push("selectaddress.aspx.6"); a.push("checkoutpayment.aspx.5"); a.push("checkoutshipping.aspx.9"); a.push("checkoutshipping.aspx.10"); a.push("checkoutshipping.aspx.11"); a.push("checkoutshipping.aspx.12"); a.push("customersupport.aspx.15"); a.push("customersupport.aspx.16"); a.push("customersupport.aspx.17"); a.push("customersupport.aspx.18"); a.push("customersupport.aspx.23"); a.push("customersupport.aspx.24"); a.push("customersupport.aspx.38"); a.push("customersupport.aspx.39"); a.push("customersupport.aspx.40"); a.push("customersupport.aspx.41"); a.push("selectaddress.aspx.7"); a.push("selectaddress.aspx.10"); a.push("selectaddress.aspx.11"); a.push("checkout1.aspx.60"); a.push("checkout1.aspx.109"); a.push("checkoutpayment.aspx.25"); ise.StringResource.loadResources(a, function () { }) } function EventsListener() { $("#opc-submit-step-1").click(function () { OnePageCheckOutStep1() }); $("#opc-submit-step-2").click(function () { $("#ise-message-tips").fadeOut("fast"); $("#step-3-error-place-holder").fadeOut("fast"); $("#step-1-error-place-holder").fadeOut("fast"); var a = $("#ctrlShippingMethod_shippingMethod").val(), b = $("#ctrlShippingMethod_freight").val(), c = $("#ctrlShippingMethod_freightCalculation").val(), d = $("#ctrlShippingMethod_realTimeRateGUID").val(); OnePageCheckoutStep2(a, b, c, d) }); $("#opc-submit-step-3").click(function () { if ("true" == ise.Configuration.getConfigValue("RequireTermsAndConditionsAtCheckout")) { var a = Boolean($("#ctrlPaymentTerm_hidNoPaymentRequired").val()); $("#ctrlPaymentTerm_termsAndConditionsChecked").is(":checked") || a ? OnePageCheckOutStep3() : ShowTermsAndConditionsMessage() } else OnePageCheckOutStep3() }); $("#edit-shipping").click(function () { OpenShippingSection() }); $("#edit-shipping-method").click(function () { $("#ise-message-tips").fadeOut("fast"); $("#step-1-error-place-holder").fadeOut("fast"); $("#step-3-error-place-holder").fadeOut("fast"); "" != $("#selected-shipping-method").html() && ShowShippingMethodsSection("", !1, !1) }); $("#ShippingAddressControl_drpType").change(function () { $("#ise-message-tips").fadeOut("slow"); $("#ShippingAddressControl_drpType").removeClass("required-input") }); $("#im-over-13-years-of-age").click(function () { $("#ise-message-tips").fadeOut("slow"); $("#age-13-place-holder").removeClass("required-input") }); $("#ise-message-tips").click(function () { $("#ise-message-tips").fadeOut("slow") }); $("#ctrlPaymentTerm_termsAndConditionsChecked").click(function () { $("#ise-message-tips").fadeOut("slow") }); $("#copyShippingInfo").click(function () { var a = !0; "" == $("#li-billing-contact").html() && (a = !1); "checked" == $(this).attr("checked") ? (UpdateBillingInfoFormValues(!1, "", a, !0), disabledBillingInfos(!0)) : (UpdateBillingInfoFormValues(!1, "", a, !1), disabledBillingInfos(!1)) }) } function disabledBillingInfos(a) { a ? ($("#BillingAddressControl_drpCountry").addClass("control-disabled"), $("#txtBillingContactName").addClass("control-disabled"), $("#txtBillingContactNumber").addClass("control-disabled"), $("#BillingAddressControl_txtStreet").addClass("control-disabled"), $("#BillingAddressControl_txtPostal").addClass("control-disabled"), $("#BillingAddressControl_txtCity").addClass("control-disabled"), $("#BillingAddressControl_txtState").addClass("control-disabled"), $("#BillingAddressControl_txtCounty").addClass("control-disabled"), $("#BillingAddressControl_drpCountry").attr("disabled", "disabled"), $("#txtBillingContactName").attr("disabled", "disabled"), $("#txtBillingContactNumber").attr("disabled", "disabled"), $("#BillingAddressControl_txtStreet").attr("disabled", "disabled"), $("#BillingAddressControl_txtPostal").attr("disabled", "disabled"), $("#BillingAddressControl_txtCity").attr("disabled", "disabled"), $("#BillingAddressControl_txtState").attr("disabled", "disabled"), $("#BillingAddressControl_txtCounty").attr("disabled", "disabled")) : ($("#BillingAddressControl_drpCountry").removeClass("control-disabled"), $("#txtBillingContactName").removeClass("control-disabled"), $("#txtBillingContactNumber").removeClass("control-disabled"), $("#BillingAddressControl_txtStreet").removeClass("control-disabled"), $("#BillingAddressControl_txtPostal").removeClass("control-disabled"), $("#BillingAddressControl_txtCity").removeClass("control-disabled"), $("#BillingAddressControl_txtState").removeClass("control-disabled"), $("#BillingAddressControl_txtCounty").removeClass("control-disabled"), $("#BillingAddressControl_drpCountry").removeAttr("disabled", "disabled"), $("#txtBillingContactName").removeAttr("disabled", "disabled"), $("#txtBillingContactNumber").removeAttr("disabled", "disabled"), $("#BillingAddressControl_txtStreet").removeAttr("disabled", "disabled"), $("#BillingAddressControl_txtPostal").removeAttr("disabled", "disabled"), $("#BillingAddressControl_txtCity").removeAttr("disabled", "disabled"), $("#BillingAddressControl_txtState").removeAttr("disabled", "disabled"), $("#BillingAddressControl_txtCounty").removeAttr("disabled", "disabled")) } function OpenPaymentsSection(a) { $("#ise-message-tips").fadeOut("fast"); $("#step-1-error-place-holder").fadeOut("fast"); $("#step-3-error-place-holder").fadeOut("fast"); $("#billing-details-wrapper-hidden").slideUp("slow", function () { $("#billing-details-wrapper").slideDown("slow", function () { a ? $("#shipping-methods-wrapper").fadeOut("slow") : (closedOpenSections("available-shipping-methods", "selected-shipping-method", "edit-shipping-method"), closedOpenSections("shipping-details-wrapper", "shipping-details-wrapper-hidden", "")); var b = !0; "" == $("#li-billing-contact").html() && (b = !1); UpdateBillingInfoFormValues(!1, "", b, !1); HideStateInputBoxForCountryWithState("BillingAddressControl") }) }); var b = $("input[name='credit-card-code']:checked").val(); "undefined" != typeof b && _GetCreditCardInfo(b, !0); b = $("input[name='multiple-billing-address']:checked").val(); "undefined" != typeof b && _GetCreditCardInfo(b, !1) } function OpenShippingSection() { $("#ise-message-tips").fadeOut("fast"); ShowStepButton("step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); $("#shipping-details-wrapper-hidden").slideUp("slow", function () { UpdateShippingInfoFormValues("", !1); $("#shipping-details-wrapper").slideDown("slow", function () { HideStateInputBoxForCountryWithState("ShippingAddressControl") }); closedOpenSections("available-shipping-methods", "selected-shipping-method", "edit-shipping-method"); closedOpenSections("billing-details-wrapper", "billing-details-wrapper-hidden", "") }); $("#step-2-error-place-holder").fadeOut("fast"); $("#step-3-error-place-holder").fadeOut("fast") } function ClearCreditCardInfo(a, b) { var c = JSON.stringify({ cardCode: a }); $.ajax({ type: "POST", url: "ActionService.asmx/ClearCreditCardInfo", data: c, contentType: "application/json; charset=utf-8", dataType: "json", success: function (a) { $("#" + b + "-credit-card-type").html("---"); $("#" + b + "-credit-card-expiry").html("---"); $("#" + b + "-credit-card-clear").html("---"); $("#" + b + "-credit-ctrlPaymentTerm_cardDescription").html(""); DisableControlPayment(!1) }, fail: function (a) { } }) } function CreditCardPanelStylesWorkAround() { $(".RedirectPaymentMethodPanel > tbody > tr > td").css("border", "0"); $(".RedirectPaymentMethodPanel > tbody > tr > td > span").addClass("strong-font"); $("#ctrlPaymentTerm_nameOnCard").addClass("light-style-input"); $("#ctrlPaymentTerm_cardNumber").addClass("light-style-input"); $("#ctrlPaymentTerm_cvv").addClass("light-style-input"); $("#ctrlPaymentTerm_cardType").addClass("light-style-input"); $("#ctrlPaymentTerm_expirationMonth").addClass("light-style-input"); $("#ctrlPaymentTerm_expirationYear").addClass("light-style-input"); "undefined" != typeof $("#ctrlPaymentTerm_startMonth") && $("#ctrlPaymentTerm_startMonth").addClass("light-style-input"); "undefined" != typeof $("#ctrlPaymentTerm_startYear") && $("#ctrlPaymentTerm_startYear").addClass("light-style-input"); $("input[name='ctrlPaymentTerm$']").click(function () { IsAnonymousUser() || ShowBillingAddress($(this).attr("pm")) }); "Credit Card" == $("input[name='ctrlPaymentTerm$']:checked").attr("pm") && "" != $("#save-as-credit-place-holder").html ? ($("#save-as-credit-place-holder").fadeIn("slow"), $("#credit-card-options").slideDown("slow")) : ($("#save-as-credit-place-holder").fadeOut("fast"), $("#credit-card-options").slideUp("slow")); $("input[name='credit-card-code']").click(function () { _GetCreditCardInfo($(this).val(), !0) }); $("input[name='multiple-billing-address']").click(function () { _GetCreditCardInfo($(this).val(), !1) }); $("input[name='multiple-shipping-address']").click(function () { GetCustomerShipTo($(this).val()) }); $(".opc-clearcard").click(function () { var a = $(this).attr("id").split("::"); ClearCreditCardInfo(a[1], a[2]) }) } function IsAnonymousUser() { return "false" == _imRegistered || !1 == _imRegistered || "undefined" == typeof _imRegistered || "" == _imRegistered } function ShowBillingAddress(a) { $("#ise-message-tips").fadeOut("fast"); "" == a && (a = $("input[name='ctrlPaymentTerm$']:checked").attr("pm")); "Credit Card" == a ? $("#credit-card-options").slideDown("slow", function () { $("#divSaveCardInfo").removeClass("display-none"); $("#billing-details-place-holder").slideDown("slow") }) : ($("#credit-card-options").slideUp("slow", function () { $("#billing-details-place-holder").slideUp("slow"); $("#divSaveCardInfo").addClass("display-none") }), $("#BillingAddressControl_txtPostal").addClass("skip"), $("#BillingAddressControl_txtState").addClass("skip")) } function closedOpenSections(a, b, c) { a = "#" + a; b = "#" + b; c = "#" + c; "#" != c && $(c).removeClass("disabled-shipping-method"); "none" != $(a).css("display") && $(a).slideUp("slow", function () { $(b).slideDown("slow", function () { }) }) } function OnePageCheckOutStep1() { $("#ise-message-tips").fadeOut("fast"); $("#step-1-error-place-holder").fadeOut("fast"); if (!IsShippingInfoGood() || !IsShippingAddressGood()) return !1; var a = $("#ProfileControl_txtShippingContactName").val(), b = $("#ProfileControl_txtShippingEmail").val(), c = $("#ProfileControl_txtShippingContactNumber").val(), d = "", e = $("#ShippingAddressControl_txtStreet").val(), g = $("#ShippingAddressControl_drpCountry").val(), h = $("#ShippingAddressControl_txtPostal").val(), d = $("#shipping-city-states").val(), f = $("#ShippingAddressControl_drpType").val(); if (f.toLowerCase() == ise.StringResource.getString("selectaddress.aspx.6").toLowerCase()) return a = $("#ShippingAddressControl_drpType").offset().left, b = $("#ShippingAddressControl_drpType").offset().top, $("#ise-message-tips").css("top", b - 47), $("#ise-message-tips").css("left", a - 17), $("#ise-message").html("Select your Residence Type"), $("#ise-message-tips").fadeIn("slow"), $("#ShippingAddressControl_drpType").addClass("required-input"), !1; $("#ise-message-tips").fadeOut("slow"); $("#ShippingAddressControl_drpType").removeClass("required-input"); "undefined" == typeof d || "other" == d ? (shippingCity = $("#ShippingAddressControl_txtCity").val(), d = $("#ShippingAddressControl_txtState").val()) : (d = d.split(", "), 1 < d.length ? (shippingCity = d[1], d = d[0]) : (shippingCity = d[0], d = "")); Step1ProcessValidator([a, b, c], [e, g, h, shippingCity, d, f]) } function Step1ProcessValidator(a, b) { ShowProcessMessage(ise.StringResource.getString("checkout1.aspx.46"), "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); AjaxCallWithSecuritySimplified("OnePageCheckoutStep1", { profile: a, shippingAddress: b, validate: !0, addressId: "" }, function (a) { var b = $("#ShippingAddressControl_txtPostal"); if ("valid" == a.d || b.hasClass("skip")) return "undefined" != typeof $.fn.RealTimeAddressVerification ? $.fn.RealTimeAddressVerification.requestAddressMatchForShipping(Step1SaveShippingContact) : Step1SaveShippingContact(), !0; if ("valid" != a.d) switch (a.d) { case "invalid-email": $("#ProfileControl_txtShippingEmail").addClass("invalid-email"); $("#ProfileControl_txtShippingEmail").focus(); ShowFailedMessage("", "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); break; case "email-duplicates": $("#ProfileControl_txtShippingEmail").addClass("email-duplicates"); $("#ProfileControl_txtShippingEmail").focus(); ShowFailedMessage("", "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); break; case "invalid-postal": $("#ShippingAddressControl_txtPostal").addClass("invalid-postal-zero"); $("#ShippingAddressControl_txtPostal").focus(); ShowFailedMessage("", "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); break; case "invalid-state": $("#ShippingAddressControl_txtState").addClass("state-not-found"); $("#ShippingAddressControl_txtState").focus(); ShowFailedMessage("", "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); break; default: ShowFailedMessage(a.d, "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder") } }, function (a) { ShowFailedMessage(a.d, "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder") }) } function Step1SaveShippingContact() { var a = $("#ProfileControl_txtShippingContactName").val(), b = $("#ProfileControl_txtShippingEmail").val(), c = $("#ProfileControl_txtShippingContactNumber").val(), d = "", e = $("#ShippingAddressControl_txtStreet").val(), g = $("#ShippingAddressControl_drpCountry").val(), h = $("#ShippingAddressControl_txtPostal").val(), f = $("#shipping-city-states").val(), k = $("#ShippingAddressControl_drpType").val(), l = $("#ShippingAddressControl_txtCounty").val(); "undefined" == typeof l && (l = ""); "undefined" == typeof f || "other" == f ? (shippingCity = $("#ShippingAddressControl_txtCity").val(), d = $("#ShippingAddressControl_txtState").val()) : (f = f.split(", "), 1 < f.length ? (shippingCity = f[1], d = f[0]) : (shippingCity = f[0], d = "")); f = $("input[name='multiple-shipping-address']:checked").val(); "undefined" == typeof f && (f = ""); a = [a, b, c]; e = [e, g, h, shippingCity, d, k, l]; ShowProcessMessage(ise.StringResource.getString("checkout1.aspx.46"), "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder"); AjaxCallWithSecuritySimplified("OnePageCheckoutStep1", { profile: a, shippingAddress: e, validate: !1, addressId: f }, function (a) { "saved" == a.d && GetCustomerInfo(!0, "shipping-contact", "") }, function (a) { ShowFailedMessage(a.d, "step-1-error-place-holder", "save-shipping-loader", "save-shipping-button-place-holder") }) } function OnePageCheckoutStep2(a, b, c, d) { ShowProcessMessage(ise.StringResource.getString("checkout1.aspx.45"), "step-2-error-place-holder", "save-shipping-method-loader", "save-shipping-method-button"); AjaxCallWithSecuritySimplified("OnePageCheckoutStep2", { shippingMethod: a, freight: b, freightCalculation: c, realTimeRateGUID: d }, function (a) { "valid" == a.d ? GetCustomerInfo(!0, "shipping-method", "") : ShowFailedMessage("Please select a shipping method", "step-2-error-place-holder", "save-shipping-method-loader", "save-shipping-method-button") }, function (a) { ShowFailedMessage(a.d, "step-2-error-place-holder", "save-shipping-method-loader", "save-shipping-method-button") }) } function OnePageCheckOutStep3() { var a = "Credit Card" == $("input[name='ctrlPaymentTerm$']:checked").attr("pm") || IsAnonymousUser(), b = $("#btnDoProcessPayment"); if (a) return a ? AddressValidation() : b.trigger("click"), !1; b.trigger("click") } function AddressValidation() { var a = $("#ctrlPaymentTerm_cardDescription").val(); "undefined" == typeof a && (a = ""); $("#txtDescription").val(a); $("#ise-message-tips").fadeOut("fast"); $("#step-1-error-place-holder").fadeOut("fast"); $("#step-3-error-place-holder").fadeOut("fast"); if (!IsBillingInfoGood() || !IsBillingAddressGood()) return !1; var b = ""; $("#BillingAddressControl_txtStreet").val(); var a = $("#BillingAddressControl_drpCountry").val(), c = $("#BillingAddressControl_txtPostal").val(), b = $("#billing-city-states").val(); "undefined" == typeof b || "other" == b ? (billingCity = $("#BillingAddressControl_txtCity").val(), b = $("#BillingAddressControl_txtState").val()) : (b = b.split(", "), 1 < b.length ? (billingCity = b[1], b = b[0]) : (billingCity = b[0], b = "")); var d = $("#im-over-13-years-of-age").is(":checked"); IsBillingInfoCorrect(a, c, b, d) } function IsBillingInfoCorrect(a, b, c, d) { ShowProcessMessage(ise.StringResource.getString("checkout1.aspx.47"), "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button"); var e = {}; e.countryCode = a; e.postalCode = b; e.stateCode = c; e.isWithRequiredAge = d; AjaxCallCommon("ActionService.asmx/IsBillingInfoCorrect", e, function (a) { var b = function () { ShowProcessMessage(ise.StringResource.getString("checkout1.aspx.48"), "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button"); var a = $("#billing-city-states").val(); "other" != a && $("#txtCityStates").val(a); $("#btnDoProcessPayment").trigger("click"); 0 < $("#errorSummary_Board_Errors").children("li").length && ShowFailedMessage("", "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button") }; if ("valid" == a.d || $("#BillingAddressControl_txtPostal").hasClass("skip")) return "undefined" != typeof $.fn.RealTimeAddressVerification ? $.fn.RealTimeAddressVerification.requestAddressMatch(b) : b(), !0; if ("valid" != a.d) switch (a.d) { case "invalid-postal": $("#BillingAddressControl_txtPostal").addClass("invalid-postal-zero"); $("#BillingAddressControl_txtPostal").focus(); ShowFailedMessage("", "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button"); break; case "invalid-state": $("#BillingAddressControl_txtState").addClass("state-not-found"); $("#BillingAddressControl_txtState").focus(); ShowFailedMessage("", "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button"); break; case "required-over-13": "undefined" != typeof $("#im-over-13-years-of-age").val() ? ($("#age-13-place-holder").addClass("required-input"), a = $("#im-over-13-years-of-age").offset().left, b = $("#im-over-13-years-of-age").offset().top, $("#ise-message-tips").css("top", b - 47), $("#ise-message-tips").css("left", a - 17), $("#ise-message").html(ise.StringResource.getString("createaccount.aspx.123")), $("#ise-message-tips").fadeIn("slow"), ShowFailedMessage("", "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button")) : $("#btnDoProcessPayment").trigger("click"); break; default: ShowFailedMessage(a.d, "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button") } }, function () { ShowFailedMessage(result.d, "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button") }) } function GetCustomerInfo(a, b, c) { var d = "undefined" == typeof $("#ctrlPaymentTerm_pnlPaymentTermOptions").attr("id"), d = JSON.stringify({ infoType: b, nopaymentOptions: d }); $.ajax({ type: "POST", url: "ActionService.asmx/GetCustomerInfo", data: d, contentType: "application/json; charset=utf-8", dataType: "json", success: function (d) { if ("" != d.d) switch (b) { case "shipping-contact": ShowShippingContactSection(d.d, a); break; case "shipping-method": if ("cart-is-empty" == d.d) return ReloadPage(""), !1; "reload-page" == d.d && a && ReloadPage("update-shipping=1"); ShowShippingMethodsSection(d.d, a, !0); break; case "payments-info": var g = "", g = c.split("::"); 0 < g.length && ("bad" == g[0] ? ShowFailedMessage(g[1], "step-3-error-place-holder", "save-billing-method-loader", "billing-method-button") : (g = g[1], ShowPaymentsSection(d.d, a, !0, g)), 0 < $("#errorSummary_Board_Errors").children("li").length && OpenPaymentsSection(!1)) } else "shipping-method" == b && ($("#edit-shipping-method").addClass("disabled-shipping-method"), d = ise.StringResource.getString("opc.freight.rate"), $("#freight-value").html(d)) }, fail: function (a) { console.log(a.d) } }) } function LoadAvailableShippingMethod(a) { a = $("input[name='multiple-shipping-address']:checked").val(); "undefined" != typeof a ? (OPC_GetShippingMethod(a), $("#selected-shipping-method").fadeOut("slow", function () { $("#available-shipping-methods").slideDown("slow"); $("#edit-shipping-method").removeClass("disabled-shipping-method") })) : ReloadPage("") } function ShowShippingContactSection(a, b) { var c = $.parseJSON(a); if (0 < c.length) { _imRegistered = c[0].Value; _finalButtonText = c[1].Value; "true" == _imRegistered ? ($("#ProfileControl_txtShippingEmail").attr("disabled", "disabled"), $("#ProfileControl_txtShippingEmail").addClass("disabled-input"), $("#ProfileControl_txtShippingEmail").addClass("display-none"), $("#lblShippingEmail").addClass("display-none"), $("#age-13-place-holder").css("display", "none"), "true" == c[11].Value && ($("#ctrlPaymentTerm_chkSaveCreditCardInfo").attr("checked", "checked"), $("#ctrlPaymentTerm_chkSaveCreditCardInfo").attr("disabled", "disabled"))) : ($("#ProfileControl_txtShippingEmail").removeAttr("disabled"), $("#ProfileControl_txtShippingEmail").removeClass("disabled-input"), $("#age-13-place-holder").css("display", "")); $("#opc-submit-step-3").val(_finalButtonText); var d = c[2].Value, e = c[3].Value, g = c[4].Value, h = c[5].Value, f = c[6].Value, k = c[7].Value, l = c[8].Value, n = c[9].Value, m = c[10].Value, p = c[12].Value, q = "true" == c[16].Value; $("#li-contact").html(d); $("#li-phone").html(g); $("#li-email").html(e); $("#li-address").html(n); $("#li-span-city").html(k); $("#li-span-state").html(l); $("#li-span-postal").html(f); $("#li-country").html(h); $("#li-residence").html(m); q && $("#li-country").addClass("display-none"); "" != p && ($("#li-county").removeClass("display-none"), $("#li-county").html(p)); $("#shipping-details-wrapper").slideUp("slow", function () { $("#shipping-details-wrapper-hidden").slideDown("slow", function () { $("#selected-shipping-method").html(); $("#edit-shipping-method").addClass("disabled-shipping-method"); b ? ReloadPage("") : $("#selected-shipping-method").fadeOut("slow", function () { $("#available-shipping-methods").slideDown("slow"); $("#edit-shipping-method").removeClass("disabled-shipping-method") }) }) }); 1 == ParseQueryString()["update-shipping"] ? DisplayPaymentSection() : CheckWhetherToRequireShipping("false" == c[13].Value, "true" == c[14].Value, "true" == c[15].Value) } } function ShowPaymentsSection(a, b, c, d) { var e = $.parseJSON(a); if (0 < e.length) { a = e[0].Value; c = e[2].Value; var g = e[3].Value, h = e[4].Value, f = e[5].Value, k = e[6].Value, l = e[7].Value, n = e[8].Value, m = e[9].Value, p = e[10].Value, e = "true" == e[11].Value; $("#li-billing-contact").html(a); $("#li-billing-phone").html(c); $("#li-billing-address").html(l); $("#li-billing-city").html(f); $("#li-billing-state").html(k); $("#li-billing-postal").html(h); $("#li-billing-country").html(g); e && $("#li-billing-country").addClass("display-none"); $("#selected-payments-method").html(n + "(" + m + ")"); "" != p && ($("#li-billing-county").removeClass("display-none"), $("#li-billing-county").html(p)); b ? ($("#step-3-error-place-holder").fadeOut("fast"), $("#billing-details-wrapper").slideUp("slow", function () { $("#billing-details-wrapper-hidden").slideDown("slow", function () { parent.location = d }) })) : $("#billing-details-wrapper").slideUp("slow", function () { $("#billing-details-wrapper-hidden").slideDown("slow", function () { }) }) } } function CheckWhetherToRequireShipping(a, b, c) { (a || b || c) && $("#shipping-methods-wrapper").fadeOut("slow", function () { $("#edit-payment-method").addClass("disabled-shipping-method"); $("#edit-shipping-method").html(""); OpenPaymentsSection(c); GetCustomerInfo(!1, "shipping-method", "") }); "true" == b && $("#coupon-free-shipping-text").html($.trim($("#lblSelectShippingMethod").html())) } function DisplayPaymentSection() { $("#shipping-methods-wrapper").fadeOut("slow", function () { $("#edit-payment-method").addClass("disabled-shipping-method"); OpenPaymentsSection(!1); GetCustomerInfo(!1, "shipping-method", "") }) } function ShowShippingMethodsSection(a, b, c) { if (c) { RegisterThisCustomerShippingMethod(a); a = "true" == ise.StringResource.getString("has-coupon-free-shipping"); c = "true" == ise.StringResource.getString("is-skip-shipping"); if ("false" == ise.StringResource.getString("has-shippable-components") || a || c) return OpenPaymentsSection(c), $("#edit-payment-method").addClass("disabled-shipping-method"), $("#shipping-methods-wrapper").fadeOut("slow"), a && $("#coupon-free-shipping-text").html($.trim($("#lblSelectShippingMethod").html())), !1; $("#shipping-methods-wrapper").fadeIn("slow"); $("#available-shipping-methods").slideUp("slow", function () { var a = ise.StringResource.getString("opc.shipping.method"), a1 = ise.StringResource.getString("opc.shipping.method.description"), c = ise.StringResource.getString("opc.freight.rate"), g = ise.StringResource.getString("opc.freight.tax"), h = ise.StringResource.getString("opc.sub.total"), f = ise.StringResource.getString("opc.grand.total"), k = ise.StringResource.getString("opc.tax"); $("#selected-shipping-method").html(a1 + " " + c); $("#selected-shipping-method").fadeIn("slow"); $("#opc-freight-rate").html(c); $("#opc-freight-tax").html(g); $("#opc-sub-total").html(h); $("#opc-grand-total").html(f); a = $("#aTaxRateValue"); a.html(k); var k = $("#divTaxBreakdownWrapper"), l = $(".hide-on-tax-breakdown-display"), c = ise.StringResource.getString("show-tax-breakdown"), g = a.attr("data-defaultTitle"); "true" == c ? a.removeClass("disabled-link").attr("title", g).attr("data-mode", "show") : (a.addClass("disabled-link").removeAttr("title"), k.is(":visible") && k.hide("slide", { direction: "up" }, function () { $this.attr("data-mode", "show"); l.css("border-bottom", "1px solid #ccc") })); b && (OpenPaymentsSection(!1), $("#edit-payment-method").addClass("disabled-shipping-method")); $("#save-shipping-method-loader").fadeOut("slow", function () { $(this).html(""); $("#save-shipping-method-button").css("display", "block"); UpdateShippingInfoFormValues("", !1) }); $("#edit-shipping-method").removeClass("disabled-shipping-method") }) } else $("#selected-shipping-method").fadeOut("slow", function () { $("#available-shipping-methods").slideDown("slow", function () { $("#edit-shipping-method").addClass("disabled-shipping-method"); closedOpenSections("billing-details-wrapper", "billing-details-wrapper-hidden", ""); closedOpenSections("shipping-details-wrapper", "shipping-details-wrapper-hidden", "") }) }) } function RegisterThisCustomerShippingMethod(a) { a = $.parseJSON(a); for (var b = 0; b < a.length; b++) ise.StringResource.registerString(a[b].Key, a[b].Value) } function UpdateShippingInfoFormValues(a, b) { var c = $("#li-contact").html(), d = $("#li-phone").html(), e = $("#li-address").html(), g = $("#li-span-city").html(), h = $("#li-span-state").html(), f = $("#li-span-postal").html(), k = $("#li-country").html(), l = $("#li-residence").html(), n = $("#li-county").html(), m = $("#li-email").html(); b && (c = a[0], e = a[1], g = a[2], h = a[3], f = a[4], k = a[5], n = a[6], d = a[7], m = a[8], l = a[9]); $("#ShippingAddressControl_drpCountry").val(k); $("#ShippingAddressControl_drpType").val(l); "" != m ? ($("#ProfileControl_txtShippingEmail").val(m), $("#lblShippingEmail").addClass("display-none")) : ($("#ProfileControl_txtShippingEmail").val(""), $("#lblShippingEmail").removeClass("display-none")); "" != c ? ($("#ProfileControl_txtShippingContactName").val(c), $("#lblShippingContactName").addClass("display-none")) : ($("#ProfileControl_txtShippingContactName").val(""), $("#lblShippingContactName").removeClass("display-none")); "" != d ? ($("#ProfileControl_txtShippingContactNumber").val(d), $("#lblShippingContactNumber").addClass("display-none")) : ($("#ProfileControl_txtShippingContactNumber").val(""), $("#lblShippingContactNumber").removeClass("display-none")); "" != e ? ($("#ShippingAddressControl_txtStreet").val(e), $("#ShippingAddressControl_lblStreet").addClass("display-none")) : ($("#ShippingAddressControl_txtStreet").val(""), $("#ShippingAddressControl_lblStreet").removeClass("display-none")); "" != f ? ($("#ShippingAddressControl_txtPostal").val(f), $("#ShippingAddressControl_lblPostal").addClass("display-none")) : ($("#ShippingAddressControl_txtPostal").val(""), $("#ShippingAddressControl_lblPostal").removeClass("display-none")); "" != g ? ($("#ShippingAddressControl_txtCity").val(g), $("#ShippingAddressControl_lblCity").addClass("display-none")) : ($("#ShippingAddressControl_txtCity").val(""), $("#ShippingAddressControl_lblCity").removeClass("display-none")); "" != h ? ($("#ShippingAddressControl_txtState").val(h), $("#ShippingAddressControl_lblState").addClass("display-none")) : ($("#ShippingAddressControl_txtState").val(""), $("#ShippingAddressControl_lblState").removeClass("display-none")); "undefined" != typeof $("#ShippingAddressControl_txtCounty").val() && ("" != n ? ($("#ShippingAddressControl_lblCounty").addClass("display-none"), $("#ShippingAddressControl_txtCounty").val(n)) : ($("#ShippingAddressControl_txtCounty").val(""), $("#ShippingAddressControl_lblCounty").removeClass("display-none"))); $(".shipping-zip-city-other-place-holder").fadeIn("Slow"); $("#shipping-enter-postal-label-place-holder").html("<input type='hidden' value='other' id='shipping-city-states'>"); UpdateOptionalPostalAttribute("ShippingAddressControl_txtPostal", "ShippingAddressControl_lblPostal", k, f) } function UpdateOptionalPostalAttribute(a, b, c, d) { a = $("#" + a); b = $("#" + b); var e = a.attr("data-postalIsOptionalIn"); c = a.ISEAddressFinder("isPostalCodeOptional", { postalIsOptionalIn: e, country: c }); a.attr("data-isOptional", c); e = a.attr("data-labeltext"); e = $.trim(e); c ? (a.addClass("is-postal-optional"), b.html(e + " (optional)")) : (a.removeClass("is-postal-optional"), b.html(e)); "" != d ? (a.val(d), b.addClass("display-none")) : c && (a.val(""), b.removeClass("display-none")) } function UpdateBillingInfoFormValues(a, b, c, d) { var e = "", g = "", h = "", f = "", k = "", l = "", n = "", m = ""; d ? (e = $("#li-contact").html(), g = $("#li-phone").html(), h = $("#li-address").html(), f = $("#li-span-city").html(), k = $("#li-span-state").html(), l = $("#li-span-postal").html(), n = $("#li-country").html(), m = $("#li-county").html()) : a ? (e = b.NameOnCard, g = b.PhoneNumber, h = b.Address, f = b.City, k = b.State, l = b.Postal, n = b.Country, m = b.County) : (e = $("#li-billing-contact").html(), g = $("#li-billing-phone").html(), h = $("#li-billing-address").html(), f = $("#li-billing-city").html(), k = $("#li-billing-state").html(), l = $("#li-billing-postal").html(), n = $("#li-billing-country").html(), m = $("#li-billing-county").html()); $("#BillingAddressControl_drpCountry").val(n); "" != e && ($("#txtBillingContactName").val(e), $("#lblBillingContactName").addClass("display-none")); "" != g && ($("#txtBillingContactNumber").val(g), $("#lblBillingContactNumber").addClass("display-none")); "" != h && ($("#BillingAddressControl_txtStreet").val(h), $("#BillingAddressControl_lblStreet").addClass("display-none")); "" != l && ($("#BillingAddressControl_txtPostal").val(l), $("#BillingAddressControl_lblPostal").addClass("display-none"), $(".billing-zip-city-other-place-holder").fadeIn("Slow"), $("#billing-enter-postal-label-place-holder").html("<input type='hidden' value='other' id='billing-city-states'>")); $("#shipping-city-states").val(); "" != f && ($("#BillingAddressControl_txtCity").val(f), $("#BillingAddressControl_lblCity").addClass("display-none")); "" != k ? ($("#BillingAddressControl_txtState").val(k), $("#BillingAddressControl_txtState").removeClass("display-none"), $("#BillingAddressControl_lblState").addClass("display-none"), $("#BillingAddressControl_txtCity").removeClass("city-width-if-no-state")) : c && ($("#BillingAddressControl_lblState").addClass("display-none"), $("#BillingAddressControl_txtState").addClass("display-none"), $("#BillingAddressControl_txtCity").addClass("city-width-if-no-state")); "undefined" != typeof $("#BillingAddressControl_txtCounty").val() && ("" != m ? ($("#BillingAddressControl_lblCounty").addClass("display-none"), $("#BillingAddressControl_txtCounty").val(m)) : ($("#BillingAddressControl_txtCounty").val(m), $("#BillingAddressControl_lblCounty").removeClass("display-none"))); UpdateOptionalPostalAttribute("BillingAddressControl_txtPostal", "BillingAddressControl_lblPostal", n, l) } function IsShippingInfoGood() { $("#ise-message-tips").fadeOut("slow"); var a = 0, b = !1, c = !1, d = []; d.push("#spare"); d.push("#ProfileControl_txtShippingContactName"); d.push("#ProfileControl_txtShippingContactNumber"); d.push("#ShippingAddressControl_txtStreet"); d.push("#ShippingAddressControl_txtPostal"); d.push("#ShippingAddressControl_txtCity"); d.push("#ShippingAddressControl_txtState"); "none" != $("#ProfileControl_txtShippingEmail").css("display") && d.push("#ProfileControl_txtShippingEmail"); $(".requires-validation").each(function () { var e = "#" + $(this).attr("id"), h = jQuery.inArray(e, d), f = trimString($(this).val()); if ("" == f && 0 < h) { c = !1; var k = $(".shipping-zip-city-other-place-holder").css("display"); "#ShippingAddressControl_txtCity" == e && ("none" == k ? c = !0 : (c = !0, "" == f && (c = !1))); if ("#ShippingAddressControl_txtState" == e) { var k = $(".shipping-zip-city-other-place-holder").css("display"), l = IsCountryWithStates("#ShippingAddressControl_drpCountry"); "none" == k || "false" == l ? c = !0 : (c = !0, "" == f && (c = !1)) } IsInArray(["BillingAddressControl_txtPostal", "ShippingAddressControl_txtPostal", "AddressControl_txtPostal"], $(this).attr("id")) && $(this).hasClass("is-postal-optional") && (c = !0); !1 == c && 0 < h && ($(this).removeClass("current-object-on-focus"), $(this).addClass("required-input"), $(e + "-label").removeClass("display-none"), $(e + "-label").css("color", "#999999"), 0 == a && ($(this).attr("id"), $(this).addClass("current-object-on-focus"), $(this).focus()), b = !0, a++) } }); if (b) return $("").focus(), !1; var e = $("#ProfileControl_txtShippingEmail"); return e.is(":visible") && (e.hasClass("invalid-email") || e.hasClass("email-duplicates")) && !1 == b ? (e.focus(), !1) : "undefined" == typeof $("#shipping-city-states").val() ? ($("#ShippingAddressControl_txtPostal").focus(), !1) : !0 } function IsShippingAddressGood() { var a = $("#ShippingAddressControl_txtPostal"), b = $(".shipping-zip-city-other-place-holder").css("display"), b = b.toLowerCase(), c = $("#ShippingAddressControl_drpCountry").val(), d = $.trim(a.val()), e = IsCountrySearchable("#ShippingAddressControl_drpCountry"), g = !1, a = a.hasClass("is-postal-optional") && "" == d; return "true" == e && !1 == a && (g = IsPostalFormatInvalid(c, d)) ? ($("#ShippingAddressControl_txtPostal").addClass("invalid-postal"), "none" == b && $("#shipping-enter-postal-label-place-holder").html(ise.StringResource.getString("customersupport.aspx.40")), $("#ShippingAddressControl_txtPostal").focus(), !1) : !0 } function IsBillingInfoGood() { $("#ise-message-tips").fadeOut("slow"); var a = 0, b = !1, c = !1, d = []; d.push("#spare"); d.push("#txtBillingContactName"); d.push("#txtBillingContactNumber"); d.push("#BillingAddressControl_txtStreet"); d.push("#BillingAddressControl_txtCity"); d.push("#BillingAddressControl_txtState"); d.push("#BillingAddressControl_txtPostal"); $(".requires-validation").each(function () { var e = "#" + $(this).attr("id"), g = jQuery.inArray(e, d), h = trimString($(this).val()); if ("" == h && 0 < g) { c = !1; var f = $(".billing-zip-city-other-place-holder").css("display"); "#BillingAddressControl_txtCity" == e && ("none" == f ? c = !0 : (c = !0, "" == h && (c = !1))); "#BillingAddressControl_txtState" == e && (f = $(".billing-zip-city-other-place-holder").css("display"), e = IsCountryWithStates("#BillingAddressControl_drpCountry"), "none" == f || "false" == e ? c = !0 : (c = !0, "" == h && (c = !1))); IsInArray(["BillingAddressControl_txtPostal", "ShippingAddressControl_txtPostal", "AddressControl_txtPostal"], $(this).attr("id")) && $(this).hasClass("is-postal-optional") && (c = !0); !1 == c && 0 < g && ($(this).removeClass("current-object-on-focus"), $(this).addClass("required-input"), 0 == a && ($(this).attr("id"), $(this).addClass("current-object-on-focus"), $(this).focus()), b = !0, a++) } }); return b ? ($("").focus(), !1) : "undefined" == typeof $("#billing-city-states").val() ? ($("#BillingAddressControl_txtPostal").focus(), !1) : !0 } function IsBillingAddressGood() { var a = $("#BillingAddressControl_txtPostal"), b = $(".billing-zip-city-other-place-holder").css("display"), b = b.toLowerCase(), c = $("#BillingAddressControl_drpCountry").val(), d = $.trim(a.val()), e = IsCountrySearchable("#BillingAddressControl_drpCountry"), g = !0, h = !1, a = a.hasClass("is-postal-optional") && "" == d; if ("true" == e && !1 == a) { if (h = IsPostalFormatInvalid(c, d)) $("#BillingAddressControl_txtPostal").addClass("invalid-postal"), "none" == b && $("#billing-enter-postal-label-place-holder").html(ise.StringResource.getString("customersupport.aspx.40")), $("#BillingAddressControl_txtPostal").focus(), g = !1; if (!g) return !1 } return !0 } function _GetCreditCardInfo(a, b) { var c = JSON.stringify({ cardCode: a }); $.ajax({ type: "POST", url: "ActionService.asmx/GetCreditCardInfo", data: c, contentType: "application/json; charset=utf-8", dataType: "json", success: function (a) { "" != a.d && (AssignValueToControlPayment(a.d), UpdateBillingInfoFormValues(!0, a.d, !0, !1), "" != a.d.CardNumber && 0 != a.d.RefNo ? DisableControlPayment(!0) : DisableControlPayment(!1)) }, fail: function (a) { } }) } function GetCustomerShipTo(a) { AjaxCallWithSecuritySimplified("GetCustomerShipTo", { ShipToCode: a }, function (a) { UpdateShippingInfoFormValues(a.d, !0); HideStateInputBoxForCountryWithState("ShippingAddressControl") }, function (a) { console.log(a.d) }) } function OPC_GetShippingMethod(a) { var b = ise.Controls.ShippingMethodController.registerControl("ctrlShippingMethod"); b && (b.registerValidator(new ise.Validators.RequiredFieldValidator("ctrlShippingMethod_ShippingMethod", "Please select a shipping method", null)), b.requestShippingMethod(a)) } function ShowStepButton(a, b, c) { $("#" + a).html(""); $("#" + a).css("display", "none"); $("#" + b).css("display", "none"); $("#" + c).css("display", "") } function AssignValueToControlPayment(a) { $("#txtCode").val(a.CreditCardCode); $("#ctrlPaymentTerm_nameOnCard").val(a.NameOnCard); $("#ctrlPaymentTerm_cardNumber").val(a.CardNumber); $("#ctrlPaymentTerm_cardType").val(a.CardType); $("#ctrlPaymentTerm_expirationMonth").val(a.ExpMonth); $("#ctrlPaymentTerm_expirationYear").val(a.ExpYear); $("#ctrlPaymentTerm_cardDescription").val(a.Description); $("#credit-card-masked").html("cardNumber"); "undefined" != typeof $("#ctrlPaymentTerm_startMonth") && $("#ctrlPaymentTerm_startMonth").val(a.StartMonth); "undefined" != typeof $("#ctrlPaymentTerm_startYear") && $("#ctrlPaymentTerm_startYear").val(a.StartYear); $("#hidMaskCardNumber").val(a.CardNumber); $("#hidCreditCardCode").val(a.CreditCardCode) } function DisableControlPayment(a) { a ? ($("#ctrlPaymentTerm_nameOnCard").attr("readonly", "true"), $("#ctrlPaymentTerm_nameOnCard").addClass("control-disabled"), $("#ctrlPaymentTerm_cardNumber").attr("readonly", "true"), $("#ctrlPaymentTerm_cardNumber").addClass("control-disabled"), $("#ctrlPaymentTerm_cardType").attr("disabled", "true"), $("#ctrlPaymentTerm_cardType").addClass("control-disabled"), $("#ctrlPaymentTerm_expirationMonth").attr("disabled", "true"), $("#ctrlPaymentTerm_expirationMonth").addClass("control-disabled"), $("#ctrlPaymentTerm_expirationYear").attr("disabled", "true"), $("#ctrlPaymentTerm_expirationYear").addClass("control-disabled"), $("#ctrlPaymentTerm_cvv").attr("readonly", "true"), $("#ctrlPaymentTerm_cvv").addClass("control-disabled"), "undefined" != typeof $("#ctrlPaymentTerm_startMonth") && ($("#ctrlPaymentTerm_startMonth").attr("disabled", "true"), $("#ctrlPaymentTerm_startMonth").addClass("control-disabled")), "undefined" != typeof $("#ctrlPaymentTerm_startYear") && ($("#ctrlPaymentTerm_startYear").attr("disabled", "true"), $("#ctrlPaymentTerm_startYear").addClass("control-disabled")), $("#ctrlPaymentTerm_cvv").parent("td").parent("tr").addClass("display-none")) : ($("#ctrlPaymentTerm_cardNumber").val(""), $("#ctrlPaymentTerm_cardType").val(""), $("#ctrlPaymentTerm_expirationMonth").val(""), $("#ctrlPaymentTerm_expirationYear").val(""), $("#ctrlPaymentTerm_cardDescription").val(""), $("#ctrlPaymentTerm_nameOnCard").removeAttr("readonly"), $("#ctrlPaymentTerm_nameOnCard").removeClass("control-disabled"), $("#ctrlPaymentTerm_cardNumber").removeAttr("readonly"), $("#ctrlPaymentTerm_cardNumber").removeClass("control-disabled"), $("#ctrlPaymentTerm_cardType").removeAttr("disabled"), $("#ctrlPaymentTerm_cardType").removeClass("control-disabled"), $("#ctrlPaymentTerm_expirationMonth").removeAttr("disabled"), $("#ctrlPaymentTerm_expirationMonth").removeClass("control-disabled"), $("#ctrlPaymentTerm_expirationYear").removeAttr("disabled"), $("#ctrlPaymentTerm_expirationYear").removeClass("control-disabled"), $("#ctrlPaymentTerm_cvv").removeAttr("readonly"), $("#ctrlPaymentTerm_cvv").removeClass("control-disabled"), $("#credit-card-masked").html(""), "undefined" != typeof $("#ctrlPaymentTerm_startMonth") && ($("#ctrlPaymentTerm_startMonth").removeAttr("disabled"), $("#ctrlPaymentTerm_startMonth").removeClass("control-disabled")), "disabled" != typeof $("#ctrlPaymentTerm_startYear") && ($("#ctrlPaymentTerm_startYear").removeAttr("readonly"), $("#ctrlPaymentTerm_startYear").removeClass("control-disabled")), $("#ctrlPaymentTerm_cvv").parent("td").parent("tr").removeClass("display-none")) } function InitPlugIn() { $("#ShippingAddressControl_txtPostal").ISEAddressFinder({ "country-id": "#ShippingAddressControl_drpCountry", "postal-id": "#ShippingAddressControl_txtPostal", "city-id": "#ShippingAddressControl_txtCity", "state-id": "#ShippingAddressControl_txtState", "city-state-place-holder": ".shipping-zip-city-other-place-holder", "enter-postal-label-place-holder": "#shipping-enter-postal-label-place-holder", "city-states-id": "shipping-city-states" }); $("#BillingAddressControl_txtPostal").ISEAddressFinder(); $("#ShippingAddressControl_txtStreet").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtStreet", "label-id": "ShippingAddressControl_lblStreet" }); $("#ShippingAddressControl_txtPostal").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtPostal", "label-id": "ShippingAddressControl_lblPostal", "input-mode": "shipping-postal", "address-type": "Shipping" }); $("#ShippingAddressControl_txtCity").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtCity", "label-id": "ShippingAddressControl_lblCity" }); $("#ShippingAddressControl_txtState").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtState", "label-id": "ShippingAddressControl_lblState", "input-mode": "shipping-state" }); "undefined" != typeof $("#ShippingAddressControl_txtCounty").val() && $("#ShippingAddressControl_txtCounty").ISEBubbleMessage({ "input-id": "ShippingAddressControl_txtCounty", "label-id": "ShippingAddressControl_lblCounty", optional: !0 }); $("#ProfileControl_txtShippingContactName").ISEBubbleMessage({ "input-id": "ProfileControl_txtShippingContactName", "label-id": "lblShippingContactName" }); $("#ProfileControl_txtShippingEmail").ISEBubbleMessage({ "input-id": "ProfileControl_txtShippingEmail", "label-id": "lblShippingEmail", "input-mode": "email" }); $("#ProfileControl_txtShippingContactNumber").ISEBubbleMessage({ "input-id": "ProfileControl_txtShippingContactNumber", "label-id": "lblShippingContactNumber" }); $("#BillingAddressControl_txtStreet").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtStreet", "label-id": "BillingAddressControl_lblStreet" }); $("#BillingAddressControl_txtPostal").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtPostal", "label-id": "BillingAddressControl_lblPostal", "input-mode": "billing-postal", "address-type": "Billing" }); $("#BillingAddressControl_txtCity").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtCity", "label-id": "BillingAddressControl_lblCity" }); $("#BillingAddressControl_txtState").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtState", "label-id": "BillingAddressControl_lblState", "input-mode": "billing-state" }); "undefined" != typeof $("#BillingAddressControl_txtCounty").val() && $("#BillingAddressControl_txtCounty").ISEBubbleMessage({ "input-id": "BillingAddressControl_txtCounty", "label-id": "BillingAddressControl_lblCounty", optional: !0 }); $("#txtBillingContactName").ISEBubbleMessage({ "input-id": "txtBillingContactName", "label-id": "lblBillingContactName" }); $("#txtBillingContactNumber").ISEBubbleMessage({ "input-id": "txtBillingContactNumber", "label-id": "lblBillingContactNumber" }) } function ShowTermsAndConditionsMessage() { $("#ctrlPaymentTerm_termsAndConditionsChecked").addClass("required-input"); var a = $("#ctrlPaymentTerm_termsAndConditionsChecked").offset().left, b = $("#ctrlPaymentTerm_termsAndConditionsChecked").offset().top; $("#ise-message-tips").css("top", b - 47); $("#ise-message-tips").css("left", a - 17); $("#ise-message").html(ise.StringResource.getString("checkoutpayment.aspx.5")); $("#ise-message-tips").fadeIn("slow") } function ParseQueryString() { for (var a = [], b, c = window.location.href.slice(window.location.href.indexOf("?") + 1).split("&"), d = 0; d < c.length; d++) b = c[d].split("="), a.push(b[0]), a[b[0]] = b[1]; return a } function ReloadPage(a) { animateMoveToTop(); var b = window.location.href.split("?")[0]; location.href = "" == a || "undefined" == typeof a ? b : b + "?" + a } function animateMoveToTop() { $("html, body").animate({ scrollTop: 0 }, 600) };